<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>hbaseç¬”è®° | é¡»è´º</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="/img/favicon.ico">
    <script>
          var _hmt = _hmt || [];
          (function() {
            var hm = document.createElement("script");
            hm.src = "https://hm.baidu.com/hm.js?9146a86d484b79eb7a9fab54d0655aa0";
            var s = document.getElementsByTagName("script")[0]; 
            s.parentNode.insertBefore(hm, s);
          })();
        </script>
    <script language="javascript" type="text/javascript" src="https://cdn.bootcdn.net/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script language="javascript" type="text/javascript" src="/js/MouseClickEffect.js"></script>
    <meta name="description" content="ã€Šé¸Ÿæ¬²é«˜é£å…ˆå±•ç¿…ï¼Œäººæ±‚ä¸Šè¿›å…ˆè¯»ä¹¦ã€‹">
    <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no">
    
    <link rel="preload" href="/assets/css/0.styles.c55ec633.css" as="style"><link rel="preload" href="/assets/js/app.7036e47e.js" as="script"><link rel="preload" href="/assets/js/4.ec8df83f.js" as="script"><link rel="preload" href="/assets/js/1.d2920358.js" as="script"><link rel="preload" href="/assets/js/2.245be42e.js" as="script"><link rel="preload" href="/assets/js/44.6e407d3e.js" as="script"><link rel="preload" href="/assets/js/12.44af248e.js" as="script"><link rel="prefetch" href="/assets/js/10.a2ab4732.js"><link rel="prefetch" href="/assets/js/11.cb2a446e.js"><link rel="prefetch" href="/assets/js/13.fe5d2510.js"><link rel="prefetch" href="/assets/js/14.a86b66a0.js"><link rel="prefetch" href="/assets/js/15.db93f4b6.js"><link rel="prefetch" href="/assets/js/16.315be0a7.js"><link rel="prefetch" href="/assets/js/17.bb33c2d3.js"><link rel="prefetch" href="/assets/js/18.aa3bc2d5.js"><link rel="prefetch" href="/assets/js/19.eb6674e0.js"><link rel="prefetch" href="/assets/js/20.26398a86.js"><link rel="prefetch" href="/assets/js/21.8573d310.js"><link rel="prefetch" href="/assets/js/22.f39eb1c6.js"><link rel="prefetch" href="/assets/js/23.70b63e87.js"><link rel="prefetch" href="/assets/js/24.780f4265.js"><link rel="prefetch" href="/assets/js/25.087b890e.js"><link rel="prefetch" href="/assets/js/26.a3432377.js"><link rel="prefetch" href="/assets/js/27.c82078d0.js"><link rel="prefetch" href="/assets/js/28.3f62dff1.js"><link rel="prefetch" href="/assets/js/29.c935e9bc.js"><link rel="prefetch" href="/assets/js/30.4acfb7de.js"><link rel="prefetch" href="/assets/js/31.3bd52897.js"><link rel="prefetch" href="/assets/js/32.cd6a4df7.js"><link rel="prefetch" href="/assets/js/33.4f206021.js"><link rel="prefetch" href="/assets/js/34.ad299da7.js"><link rel="prefetch" href="/assets/js/35.a74cd3c6.js"><link rel="prefetch" href="/assets/js/36.a6d81e30.js"><link rel="prefetch" href="/assets/js/37.e3323ce2.js"><link rel="prefetch" href="/assets/js/38.18d7dd67.js"><link rel="prefetch" href="/assets/js/39.833f42ab.js"><link rel="prefetch" href="/assets/js/40.ed6400f3.js"><link rel="prefetch" href="/assets/js/41.81e6fc53.js"><link rel="prefetch" href="/assets/js/42.d0e39d51.js"><link rel="prefetch" href="/assets/js/43.047ac597.js"><link rel="prefetch" href="/assets/js/45.234ad067.js"><link rel="prefetch" href="/assets/js/46.3eaaa14c.js"><link rel="prefetch" href="/assets/js/47.cd7ab522.js"><link rel="prefetch" href="/assets/js/48.d146214c.js"><link rel="prefetch" href="/assets/js/49.5412d8fd.js"><link rel="prefetch" href="/assets/js/5.83420c85.js"><link rel="prefetch" href="/assets/js/50.361271e2.js"><link rel="prefetch" href="/assets/js/51.2488c147.js"><link rel="prefetch" href="/assets/js/52.a5eb5e9f.js"><link rel="prefetch" href="/assets/js/53.c3859002.js"><link rel="prefetch" href="/assets/js/54.c572a44d.js"><link rel="prefetch" href="/assets/js/55.30248800.js"><link rel="prefetch" href="/assets/js/56.248288b0.js"><link rel="prefetch" href="/assets/js/57.3a11d1c7.js"><link rel="prefetch" href="/assets/js/58.95fa43c5.js"><link rel="prefetch" href="/assets/js/59.d002a857.js"><link rel="prefetch" href="/assets/js/6.5faf5a50.js"><link rel="prefetch" href="/assets/js/60.26b4ef39.js"><link rel="prefetch" href="/assets/js/61.7c152e5e.js"><link rel="prefetch" href="/assets/js/62.baeb52bb.js"><link rel="prefetch" href="/assets/js/63.8978958b.js"><link rel="prefetch" href="/assets/js/64.b14585b3.js"><link rel="prefetch" href="/assets/js/7.13c62f03.js"><link rel="prefetch" href="/assets/js/8.b2b362e0.js"><link rel="prefetch" href="/assets/js/9.0fd0389d.js">
    <link rel="stylesheet" href="/assets/css/0.styles.c55ec633.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container no-sidebar" data-v-faf1ae92><div data-v-faf1ae92><div id="loader-wrapper" class="loading-wrapper" data-v-d48f4d20 data-v-faf1ae92 data-v-faf1ae92><div class="loader-main" data-v-d48f4d20><div data-v-d48f4d20></div><div data-v-d48f4d20></div><div data-v-d48f4d20></div><div data-v-d48f4d20></div></div> <!----> <!----></div> <div class="password-shadow password-wrapper-out" style="display:none;" data-v-5cb9a64e data-v-faf1ae92 data-v-faf1ae92><h3 class="title" style="display:none;" data-v-5cb9a64e data-v-5cb9a64e>é¡»è´º</h3> <!----> <label id="box" class="inputBox" style="display:none;" data-v-5cb9a64e data-v-5cb9a64e><input type="password" value="" data-v-5cb9a64e> <span data-v-5cb9a64e>Konck! Knock!</span> <button data-v-5cb9a64e>OK</button></label> <div class="footer" style="display:none;" data-v-5cb9a64e data-v-5cb9a64e><span data-v-5cb9a64e><i class="iconfont reco-theme" data-v-5cb9a64e></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-5cb9a64e>vuePress-theme-reco</a></span> <span data-v-5cb9a64e><i class="iconfont reco-copyright" data-v-5cb9a64e></i> <a data-v-5cb9a64e><span data-v-5cb9a64e>ğŸˆ</span>
          Â Â 
          <span data-v-5cb9a64e>2021 - </span>
          2023
        </a></span></div></div> <div class="hide" data-v-faf1ae92><div data-v-faf1ae92><div id="smart" class="wrapper-page" style="background-image:url(/img/bjt3.jpg);background-position-x:center;background-position-y:center;background-size:cover;background-repeat-x:no-repeat;background-repeat-y:no-repeat;" data-v-faf1ae92><header class="navbar" data-v-faf1ae92><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/img/favicon.ico" alt="é¡»è´º" class="logo"> <span class="site-name">é¡»è´º</span></a> <div class="links"><div id="dayNightSwitch" class="generalWrapper" data-v-32f44868><a class="click" data-v-32f44868><div class="onOff daySwitch" data-v-32f44868><div class="star star1" data-v-32f44868></div> <div class="star star2" data-v-32f44868></div> <div class="star star3" data-v-32f44868></div> <div class="star star4" data-v-32f44868></div> <div class="star star5" data-v-32f44868></div> <div class="star sky" data-v-32f44868></div> <div class="sunMoon" data-v-32f44868><div class="crater crater1" data-v-32f44868></div> <div class="crater crater2" data-v-32f44868></div> <div class="crater crater3" data-v-32f44868></div> <div class="cloud part1" data-v-32f44868></div> <div class="cloud part2" data-v-32f44868></div></div></div></a></div> <div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link"><i class="iconfont reco-home"></i>
  ä¸»é¡µ
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-category"></i>
      åˆ†ç±»
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/java/" class="nav-link"><i class="iconfont undefined"></i>
  java
</a></li><li class="dropdown-item"><!----> <a href="/categories/å…¶ä»–/" class="nav-link"><i class="iconfont undefined"></i>
  å…¶ä»–
</a></li><li class="dropdown-item"><!----> <a href="/categories/æ”¶è—/" class="nav-link"><i class="iconfont undefined"></i>
  æ”¶è—
</a></li><li class="dropdown-item"><!----> <a href="/categories/å‰ç«¯/" class="nav-link"><i class="iconfont undefined"></i>
  å‰ç«¯
</a></li><li class="dropdown-item"><!----> <a href="/categories/å®‰è£…/" class="nav-link"><i class="iconfont undefined"></i>
  å®‰è£…
</a></li><li class="dropdown-item"><!----> <a href="/categories/ç¬”è®°/" class="nav-link"><i class="iconfont undefined"></i>
  ç¬”è®°
</a></li><li class="dropdown-item"><!----> <a href="/categories/è¸©å‘/" class="nav-link"><i class="iconfont undefined"></i>
  è¸©å‘
</a></li></ul></div></div><div class="nav-item"><a href="/tag/" class="nav-link"><i class="iconfont reco-tag"></i>
  æ ‡ç­¾
</a></div><div class="nav-item"><a href="/timeline/" class="nav-link"><i class="iconfont reco-date"></i>
  æ—¶é—´è½´
</a></div><div class="nav-item"><a href="/view/reward/" class="nav-link"><i class="iconfont undefined"></i>
  å¥–åŠ±
</a></div><div class="nav-item"><a href="/about/" class="nav-link"><i class="iconfont reco-account"></i>
  å…³äº
</a></div> <!----></nav></div></header> <div class="sidebar-mask" data-v-faf1ae92></div> <aside class="sidebar" data-v-faf1ae92><div class="personal-info-wrapper" data-v-03833281 data-v-faf1ae92><img src="/img/author.png" alt="author-avatar" class="personal-img" data-v-03833281> <h3 class="name" data-v-03833281>
    ğŸˆ
  </h3> <div class="num" data-v-03833281><div data-v-03833281><h3 data-v-03833281>43</h3> <h6 data-v-03833281>æ–‡ç« </h6></div> <div data-v-03833281><h3 data-v-03833281>32</h3> <h6 data-v-03833281>æ ‡ç­¾</h6></div></div> <hr data-v-03833281></div> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link"><i class="iconfont reco-home"></i>
  ä¸»é¡µ
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-category"></i>
      åˆ†ç±»
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/java/" class="nav-link"><i class="iconfont undefined"></i>
  java
</a></li><li class="dropdown-item"><!----> <a href="/categories/å…¶ä»–/" class="nav-link"><i class="iconfont undefined"></i>
  å…¶ä»–
</a></li><li class="dropdown-item"><!----> <a href="/categories/æ”¶è—/" class="nav-link"><i class="iconfont undefined"></i>
  æ”¶è—
</a></li><li class="dropdown-item"><!----> <a href="/categories/å‰ç«¯/" class="nav-link"><i class="iconfont undefined"></i>
  å‰ç«¯
</a></li><li class="dropdown-item"><!----> <a href="/categories/å®‰è£…/" class="nav-link"><i class="iconfont undefined"></i>
  å®‰è£…
</a></li><li class="dropdown-item"><!----> <a href="/categories/ç¬”è®°/" class="nav-link"><i class="iconfont undefined"></i>
  ç¬”è®°
</a></li><li class="dropdown-item"><!----> <a href="/categories/è¸©å‘/" class="nav-link"><i class="iconfont undefined"></i>
  è¸©å‘
</a></li></ul></div></div><div class="nav-item"><a href="/tag/" class="nav-link"><i class="iconfont reco-tag"></i>
  æ ‡ç­¾
</a></div><div class="nav-item"><a href="/timeline/" class="nav-link"><i class="iconfont reco-date"></i>
  æ—¶é—´è½´
</a></div><div class="nav-item"><a href="/view/reward/" class="nav-link"><i class="iconfont undefined"></i>
  å¥–åŠ±
</a></div><div class="nav-item"><a href="/about/" class="nav-link"><i class="iconfont reco-account"></i>
  å…³äº
</a></div> <!----></nav> <!----> </aside> <div class="password-shadow password-wrapper-in" style="display:none;" data-v-5cb9a64e data-v-faf1ae92><h3 class="title" style="display:none;" data-v-5cb9a64e data-v-5cb9a64e>hbaseç¬”è®°</h3> <!----> <label id="box" class="inputBox" style="display:none;" data-v-5cb9a64e data-v-5cb9a64e><input type="password" value="" data-v-5cb9a64e> <span data-v-5cb9a64e>Konck! Knock!</span> <button data-v-5cb9a64e>OK</button></label> <div class="footer" style="display:none;" data-v-5cb9a64e data-v-5cb9a64e><span data-v-5cb9a64e><i class="iconfont reco-theme" data-v-5cb9a64e></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-5cb9a64e>vuePress-theme-reco</a></span> <span data-v-5cb9a64e><i class="iconfont reco-copyright" data-v-5cb9a64e></i> <a data-v-5cb9a64e><span data-v-5cb9a64e>ğŸˆ</span>
          Â Â 
          <span data-v-5cb9a64e>2021 - </span>
          2023
        </a></span></div></div></div> <div data-v-faf1ae92><main class="page"><div class="page-title" style="display:none;"><h1 class="title">hbaseç¬”è®°</h1> <div class="page-info" data-v-0efa1f05><i class="iconfont reco-account" data-v-0efa1f05><span data-v-0efa1f05>ğŸˆ</span></i> <i class="iconfont reco-date" data-v-0efa1f05><span data-v-0efa1f05>2021-09-15</span></i> <i class="iconfont reco-eye" data-v-0efa1f05><span id="/view/docs/%E7%AC%94%E8%AE%B0/11.hbase.html" data-flag-title="Your Article Title" class="leancloud-visitors" data-v-0efa1f05><a class="leancloud-visitors-count" style="font-size:.9rem;font-weight:normal;color:#999;"></a></span></i> <i class="iconfont reco-tag tags" data-v-0efa1f05><span class="tag-item" data-v-0efa1f05>hbase</span></i></div></div> <div class="theme-reco-content content__default" style="display:none;"><h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="header-anchor">#</a> ç®€ä»‹</h2> <p>HBase æ˜¯ä¸€ç§<strong>åˆ†å¸ƒå¼</strong>ã€<strong>å¯æ‰©å±•</strong>ã€æ”¯æŒ<strong>æµ·é‡æ•°æ®</strong>å­˜å‚¨Nosqlæ•°æ®åº“</p> <p>åŸè°·æ­Œä¸‰å¤§è®ºæ–‡ä¹‹ä¸€Bigtableæ¼”åŒ–æˆHBase   (GFSæ˜¯hdfs,mrå°±æ˜¯mr)</p> <p>åŸºäºhdfs,å¯ä»¥<strong>å®ç°éšæœºå†™æ“ä½œ</strong>ã€‚ç§’çº§å“åº”(æ–¹å¼åˆä¹…å¿…åˆ†ï¼Œåˆ†ä¹…å¿…åˆ)</p> <p><strong>æ•°æ®ç»“æ„</strong>ï¼šé€»è¾‘ç»“æ„è¡¨ï¼Œç‰©ç†å­˜å‚¨ç»“æ„KV</p> <p><strong>é€»è¾‘ç»“æ„</strong>ï¼šå…ƒæ•°æ®</p> <p>å°†å¾ˆå¤šåˆ—åˆ†å‡ºæ¥ç»„æˆä¸€ä¸ªåˆ—æ—,ä»ä¸Šå¾€ä¸‹å«Row key æŒ‰ç…§å­—å…¸åºæ’åºï¼Œè€Œä¸”å”¯ä¸€,ä¸å”¯ä¸€å°±æ˜¯è¦†ç›–ã€‚</p> <p>(å®½è¡¨)çºµå‘åˆ‡åˆ†å«åˆ—æ—,(é•¿è¡¨)æ¨ªå‘åˆ‡åˆ†çš„å«Regionï¼Œåˆ‡åˆ†åéƒ½æ”¾ç½®ä¸åŒæ–‡ä»¶å¤¹ã€‚å®é™…æ•°æ®å­˜å‚¨åˆ°Storeé‡Œé¢</p> <p><strong>å­˜å‚¨ç»“æ„</strong>ï¼š</p> <p>å¯¹äºæ¯ä¸€ä¸ªåˆ—:éƒ½å­˜å‚¨äº†åˆ—æ—ã€åˆ—åã€Rowkeyã€timeStamp<strong>æ—¶é—´æˆ³</strong>(ç‰ˆæœ¬å·)ã€æ“ä½œç±»å‹ã€å€¼</p> <blockquote><p>æœ€åä¼šæ ¡éªŒæ—¶é—´æˆ³(<strong>è¿”å›æ—¶é—´æœ€å¤§çš„</strong>)ï¼Œå¦‚æœä¸ä¸€è‡´æ“ä½œä¼šå‡ºé—®é¢˜</p> <p>åˆ é™¤æ“ä½œ:rowkeyç›¸åŒ,ç±»å‹æ˜¯delet,ç„¶åæ¯”å¯¹æ—¶é—´æˆ³(å¦‚æœæ˜¯æœ€å¤§)æ‰§è¡ŒæˆåŠŸ,è¿”å›åˆ é™¤</p> <p>ä¸ä¼šç«‹é©¬åˆ é™¤</p></blockquote> <p><strong>æ•°æ®æ¨¡å¼</strong>ï¼š</p> <ul><li><p>Name Space :å‘½åç©ºé—´ ç±»ä¼¼database</p> <blockquote><p>é»˜è®¤ï¼šhbase(å†…ç½®è¡¨) ã€default(é»˜è®¤ç”¨æˆ·ä½¿ç”¨çš„å‘½åç©ºé—´)</p></blockquote></li> <li><p>Regionï¼š<strong>è¡¨</strong> çš„åˆ‡ç‰‡(å°è¡¨) ã€å®šä¹‰åˆ—æ—å³å¯ã€åˆ—æ˜¯åŠ¨æ€å¢åŠ çš„</p></li> <li><p>Rowï¼šæ¯è¡Œæ•°æ®åˆä¸€ä¸ªrowkey(å­—å…¸åº)å’Œå¤šä¸ªåˆ—ç»„æˆ</p></li> <li><p>column:æ¯ä¸ªåˆ—éœ€è¦æŒ‡å®šåˆ—æ—ä¸åˆ—é™å®šç¬¦</p></li> <li><p>Time stamp:æ—¶é—´æˆ³æ ‡è¯†ç‰ˆæœ¬</p></li> <li><p>cell:å”¯ä¸€ç¡®è®¤çš„å•å…ƒ(æœ€å°)</p></li></ul> <p><strong>åŸºç¡€æ¶æ„</strong>ï¼š</p> <p>masteræ“ä½œè¡¨çš„DDLï¼Œzookeeperç®¡ç†,å…¶ä¸­storeFileå­˜å‚¨åˆ°Storeï¼ŒStoreå­˜å‚¨åˆ°Region,Regionå­˜å‚¨åˆ°RegionServer åˆ†å¸ƒå¼ï¼Œ</p> <p>RegionServerä½œç”¨:DML</p> <ul><li>Data:getã€putã€delete</li> <li>Regionï¼šSplitRegionã€compactRegin</li></ul> <p>masterä½œç”¨ï¼šDDL</p> <ul><li>table:createã€deleteã€alter</li> <li>RegionServerï¼šåˆ†é…Regionåˆ°æ¯ä¸ªRegionServer,ç›‘æ§RegionServerçŠ¶æ€</li></ul> <blockquote><p><strong>è‡ªå¸¦é«˜å¯ç”¨</strong>(ä¿©ä¸ªmaster)</p></blockquote> <blockquote><p>æœ€ç»ˆæ–‡ä»¶å­˜å‚¨åˆ°hdfs,è€Œhdfså­˜å‚¨åˆ°datanodeä¸­ï¼Œè€Œdatanodeå­˜å‚¨åˆ°linuxä¸­,ç„¶åå­˜å‚¨åˆ°ç£ç›˜ä¸Šã€‚</p></blockquote> <h2 id="å…¥é—¨"><a href="#å…¥é—¨" class="header-anchor">#</a> å…¥é—¨</h2> <p><strong>éƒ¨ç½²</strong>ï¼š</p> <ol><li><p>ä¸Šæ¬¡å®‰è£…åŒ…</p></li> <li><p>è§£å‹æ”¹å</p></li> <li><p>ä¿®æ”¹é…ç½®æ–‡ä»¶</p> <ul><li><p>regionservers é›†ç¾¤</p> <div class="language-xml line-numbers-mode"><pre class="language-xml"><code>hadoop111
hadoop112
hadoop113
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div></li> <li><p>hbase-env.sh é…ç½®è„šæœ¬æ‰§è¡Œæ–‡ä»¶</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>#æŸ¥çœ‹javahome
[hadoop101@axcmsm111 conf]$ echo $JAVA_HOME
/opt/module/jdk1.8.0_141
#é…ç½®JAVAç¯å¢ƒå˜é‡
export JAVA_HOME=/opt/module/jdk1.8.0_141
#æ³¨é‡Šæ‰(å¯é€‰,jdk1.7å¯ä»¥åˆ æ‰)
# export HBASE_MASTER_OPTS=&quot;$HBASE_MASTER_OPTS -XX:PermSize=128m -XX:MaxPermSize=128m&quot;
# export HBASE_REGIONSERVER_OPTS=&quot;$HBASE_REGIONSERVER_OPTS -XX:PermSize=128m -XX:MaxPermSize=128m&quot;

#é™æ­¢å¯åŠ¨é»˜è®¤çš„zk
export HBASE_MANAGES_ZK=false
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div></li> <li><p>hbase-site.xml</p> <div class="language-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>configuration</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>hbase.rootdir<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>hdfs://hadoop111:9000/HBase<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>hbase.cluster.distributed<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
 <span class="token comment">&lt;!-- 0.98 åçš„æ–°å˜åŠ¨ï¼Œä¹‹å‰ç‰ˆæœ¬æ²¡æœ‰.port,é»˜è®¤ç«¯å£ä¸º 60000 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>hbase.master.port<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>16000<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span> 
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>hbase.zookeeper.quorum<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>hadoop111,hadoop112,hadoop113<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span> 
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>hbase.zookeeper.property.dataDir<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>/opt/module/zookeeper-3.6.3/zkData<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>configuration</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div></li></ul></li> <li><p>é…ç½®è½¯é“¾æ¥</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">ln</span> -s /opt/module/hadoop-3.1.4/etc/hadoop/core-site.xml /opt/module/hbase/conf/core-site.xml

<span class="token function">ln</span> -s /opt/module/hadoop-3.1.4/etc/hadoop/hdfs-site.xml /opt/module/hbase/conf/hdfs-site.xml
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div></li> <li><p>åˆ†å‘è„šæœ¬</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code> xsync hbase/
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p>å¯åŠ¨ ç«¯å£16010</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>ç¾¤èµ·
 ./bin/start-hbase.sh #ç¬¬ä¸€æ¬¡å¯èƒ½ä¼šåˆå»¶è¿Ÿ
 
#å•èŠ‚ç‚¹
bin/hbase-daemon.sh start master #å¯åŠ¨ygmaster
bin/hbase-daemon.sh start regionserver #å¯åŠ¨å¤šä¸ª
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div></li> <li><p>å…³é—­</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>ç¾¤å…³
./bin/stop-hbase.sh 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></li></ol> <p><strong>å‘½ä»¤è¡Œæ“ä½œ</strong>ï¼š<code>bin/hbase shell è¿›å…¥å‘½ä»¤è¡Œ</code> <code>help å¸®åŠ©</code> <code>list æŸ¥çœ‹åˆ—è¡¨</code></p> <p>æç¤ºï¼šåˆ é™¤ <code>ctrl+delete</code> ä¸éœ€è¦åˆ†å·ç»“å°¾  tapæç¤º</p> <p>helpæŸ¥çœ‹</p> <div class="language- line-numbers-mode"><pre class="language-text"><code> Group name: ddl
  Commands: alter, alter_async, alter_status, create, describe, disable, disable_all, drop, drop_all, enable, enable_all, exists, get_table, is_disabled, is_enabled, list, locate_region, show_filters
  Group name: dml
  Commands: append, count, delete, deleteall, get, get_counter, get_splits, incr, put, scan, truncate, truncate_preserve
  ....
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>è¡¨æ“ä½œï¼šè¡¨å(&quot;åº“å:è¡¨å&quot;)  åˆ—(&quot;åˆ—æ—:åˆ—&quot;)</p> <ul><li>åˆ›å»ºè¡¨ create è¡¨å,åˆ—æ—1ï¼Œåˆ—æ—2ï¼Œ3.....(é»˜è®¤å­˜å‚¨åˆ°difaultå‘½åç©ºé—´)</li> <li>æŸ¥çœ‹è¡¨ç»“æ„ describe 'è¡¨å'</li> <li>ä¿®æ”¹è¡¨ä¿¡æ¯   alter â€™è¡¨åâ€˜ï¼Œ{NAME=&gt;'åˆ—æ—',VERSIONS=&gt;3}</li> <li>disable â€™è¡¨åâ€˜ å…ˆä¸‹çº¿  å†åˆ é™¤è¡¨ drop â€™è¡¨åâ€˜</li> <li>æŸ¥çœ‹è¡¨ä¿¡æ¯  scan 'student'</li> <li>åˆ›å»ºå‘½åç©ºé—´ï¼šcreate_namespace 'åå­—'</li> <li>æŸ¥çœ‹å‘½åç©ºé—´ï¼šlist_namespace</li> <li>æŒ‡å®šå‘½åç©ºé—´åˆ›å»ºè¡¨ï¼šcreate â€å‘½åç©ºé—´å:è¡¨åâ€œ,&quot;åˆ—æ—â€œ</li> <li>åˆ é™¤å‘½åç©ºé—´ï¼šå…ˆä¸‹çº¿è¡¨ï¼Œå†åˆ é™¤è¡¨ï¼Œå†å‘åˆ é™¤å‘½åç©ºé—´(drop_namespace)(ä¹Ÿå¯ä»¥è®¾ç½®å­˜å‚¨å¤šå°‘è¡¨)</li> <li>åˆ·å†™ç£ç›˜ flush â€è¡¨åâ€œ</li></ul> <p><strong>DML</strong>:(çœ‹æ—¶é—´æˆ³)</p> <ul><li><p>å¢ ï¼šput &quot;åº“:è¡¨&quot;ï¼Œ&quot;rowkey&quot;,&quot;åˆ—æ—:åˆ—&quot;,&quot;æ•°æ®&quot;</p></li> <li><p>æŸ¥</p> <ul><li><p>scan â€è¡¨åâ€œ  (å¯ä»¥åŠ è¿‡æ»¤æ¡ä»¶ç­‰ç­‰...)</p></li> <li><p>get  &quot;è¡¨å&quot;,&quot;rowkey&quot;</p> <blockquote><p>å¯ä»¥æŒ‡å®šåˆ—å,åˆ—æ—</p></blockquote></li></ul></li> <li><p>æ”¹ï¼šput &quot;åº“:è¡¨&quot;ï¼Œ&quot;rowkey&quot;,&quot;åˆ—æ—:åˆ—&quot;,&quot;æ•°æ®&quot;</p></li> <li><p>åˆ ï¼š</p> <ul><li><p>delete â€è¡¨&quot;,&quot;rowkeyâ€,â€åˆ—â€œ</p> <blockquote><p>ä¹Ÿå¯ä»¥æŒ‰ç…§æ—¶é—´æˆ³åˆ é™¤(æ—¶é—´æˆ³æ¯”ä»–å¤§çš„åˆ é™¤)</p></blockquote></li> <li><p>deleteall &quot;è¡¨&quot;ï¼Œ&quot;rowkey&quot;</p></li> <li><p>truncate â€œè¡¨â€ æ¸…ç©ºè¡¨</p></li></ul></li></ul> <h2 id="è¿›é˜¶"><a href="#è¿›é˜¶" class="header-anchor">#</a> è¿›é˜¶</h2> <p><strong>æ¶æ„åŸç†</strong>:
<img src="https://gitee.com/axcmsm/tmp/raw/master/bigdata/20210919235840.png" alt=""></p> <p>æ•°æ®æœ€åå­˜å‚¨åˆ°hdfsçš„datanodeä¸­,HMaster DDLç®¡ç†è¡¨,ç®¡ç†HRegionServer,ZKåˆ†æ‹…å·¥ä½œé‡ï¼ŒHRegionServeråŒ…å«Hlog(é¢„å†™å…¥æ—¥å¿—)ã€å¤šä¸ªHRegin(æŒ‰è¡Œåˆ‡åˆ†,é‡Œé¢åŒ…å«å¤šä¸ªåˆ—æ—sotre.memstore(åˆ·å†™),stroeFilme(æ–‡ä»¶))é‡Œé¢çš„å­˜å‚¨æ ¼å¼æ˜¯Hfile(é”®å€¼å¯¹),<strong>åˆ—æ—</strong>æ˜¯<strong>é€»è¾‘ç»“æ„çœŸå®æ–‡ä»¶å¤¹æ˜¯store</strong></p> <p>zkåˆ†æ‹…äº†HMasterä¸å®¢æˆ·ç«¯çš„äº¤äº’ï¼Œlå®¢æˆ·ç«¯ç›´æ¥è·Ÿzkäº¤äº’ï¼Œ</p> <p>å¦‚æœæ“ä½œæ˜¯DMLæ‰¾zk,DDLè¿˜æ˜¯éœ€è¦è·ŸHMasteräº¤äº’</p> <blockquote><p>memstoreåˆ·é‹è¿‡ç¨‹è¦ç»è¿‡è·Ÿhdfså®¢æˆ·ç«¯äº¤äº’æœ€ååˆ·å†™åˆ°datanode</p> <p>ä¹Ÿå°±æ˜¯ç£ç›˜ä¸Šã€‚</p></blockquote> <p><strong>å†™æµç¨‹</strong>ï¼šRegionServerç®€ç§°RS</p> <p>å®¢æˆ·ç«¯å‘zkè¯·æ±‚meta(ç»“æ„)è¡¨æ‰€åœ¨çš„çš„RS(è°åœ¨ç»´æŠ¤),å‡è®¾zkè¿”å›hadoop111(å®ƒåœ¨ç»´æŠ¤)ï¼Œå®¢æˆ·ç«¯å†å‘Hbaseä¸­è¯·æ±‚meta(è¡¨ä¿¡æ¯),hbaseè¿”å›meta,è·å–RS(æ•°æ®æ‰€åœ¨ä½ç½®),åšmetaç¼“å­˜ï¼Œå†å‘é€putè¯·æ±‚,å…ˆå†™å…¥é¢„å†™æ—¥å¿—,å†å†™å…¥memstoreç¼“å­˜,å†å†™å…¥storefileæ–‡ä»¶ã€‚</p> <p><img src="https://gitee.com/axcmsm/tmp/raw/master/bigdata/%E8%AF%BB%E5%86%99%E6%95%B0%E6%8D%AE%E5%BE%AE%E8%A7%82%E6%B5%81%E7%A8%8B.png" alt=""></p> <blockquote><p>åœ¨0.9ä¹‹å‰è¿˜æœ‰-root-è¡¨ å…¶ä»–è¡¨å¾€åæ¨ä¸€æ­¥ã€‚</p> <p>ç°åœ¨æ”¹å˜äº†ï¼Œåœ¨åˆ‡åˆ†ä¹‹å‰ä¼šå…ˆåˆ¤æ–­æ˜¯å¦æ˜¯metaè¡¨</p></blockquote> <p><strong>åˆ·å†™æµç¨‹</strong>ï¼š</p> <p><strong>RSçº§åˆ«</strong>ï¼šé‡Œé¢æœ‰å¤šä¸ªhr</p> <p>é»˜è®¤å è¶…è¿‡RSçš„å †å†…å­˜çš„40%åˆ·å†™åˆ°ç£ç›˜(å†…å­˜å µå¡è¡Œä¸º)</p> <p>å®‰å…¨æ¨¡å¼,å å †å†…å­˜çš„95%(ä¹Ÿå°±æ˜¯0.38)ä¹Ÿå¼€å§‹åˆ·å†™(æ²¡æœ‰å µå¡ç›´æ¥åˆ·å†™,ä¸€è¾¹å†™å…¥ç¼“å­˜ï¼Œä¸€è¾¹åˆ·å†™ç£ç›˜,å½“å†™å…¥ç¼“å­˜é€Ÿåº¦æ¯”å†™ç£ç›˜å¿«,åˆ°å †å†…å­˜40%ï¼Œè¿›å…¥å µå¡,ä¸è¦å¾€å†…å­˜å†™,ä¸ç„¶çˆ†äº†,ç­‰åˆ°0.38ä»¥ä¸‹å†å¼€å¯å†™å…¥ç¼“å­˜)</p> <p>å½“å†…å­˜æœ€åä¸€æ¬¡æ“ä½œæ—¶é—´,è¿‡äº†ä¸€ä¸ªå°æ—¶(è®¤ä¸ºæ²¡æœ‰æ“ä½œ,ä¹Ÿä¼šè¿›è¡Œåˆ·å†™)</p> <p><strong>hrçº§åˆ«</strong>ï¼šhrä¸­çš„memstore</p> <p>å½“å‰çš„memstoreåˆ°è¾¾äº†128M,å•ä¸ªè¿›è¡Œåˆ·å†™(é‡Œé¢è¿˜æœ‰walé¢„åˆ·å†™æ“ä½œ)</p> <p><strong>è¯»æµç¨‹</strong>ï¼š</p> <p>å…ˆè¯»å†…å­˜ï¼Œå†æ‰¾zk,æ‰¾metaä½ç½®,è¯·æ±‚metaæŸ¥æ‰¾RSä½ç½®,ç¼“å­˜ä½ç½®,å†è¯·æ±‚å¯¹åº”RS,å…¶ä¸­RSä¸­æœ‰ä¸€å—Block Cacheç”¨æ¥ç¼“å­˜æœ€è¿‘è¯»å–çš„æ•°æ®(éµå¾ªæœ€è¿‘æœ€å°‘åŸåˆ™,æ»¡å†…å­˜å°±å¼€åˆ ä¸€éƒ¨åˆ†),è¯»å–è¿™ä¸ªç¼“å­˜ï¼Œä¹Ÿå»è¯»ç£ç›˜æ•°æ®,ç„¶åè¿›è¡Œæ¯”å¯¹æ—¶é—´æˆ³ã€‚</p> <blockquote><p>æ•°æ®é‡å¤§çš„å‡ ä¹éƒ½æ˜¯è¯»ç£ç›˜çš„,æ‰€ä»¥hbaseæ˜¯ä¸€ä¸ª<strong>è¯»æ¯”å†™æ…¢</strong>çš„æ¡†æ¶</p></blockquote> <p><strong>åˆå¹¶æ•°æ®</strong>ï¼šstoreFile Compaction</p> <ul><li><p>Minor Compaction å°åˆå¹¶(ä¸åˆ æ•°æ®)</p></li> <li><p>Major Compaction å…¨å±€åˆå¹¶(åˆå¹¶æˆä¸€ä¸ª)  <code>compact 'è¡¨å'</code></p> <blockquote><p>ç”Ÿäº§æƒ…å†µå»ºè®®è®¾ç½®ä¸º0,å…³é—­è‡ªåŠ¨åˆå¹¶,ä»¥ä¸ºæ˜¯é‡å†™,å…ˆè¯»å†å†™,å½±å“ä¸šåŠ¡ï¼Œå»ºè®®åœ¨ç©ºé—²æ—¶é—´,æ‰‹åŠ¨å…¨å±€åˆå¹¶</p> <p><strong>å…¨å±€åˆå¹¶</strong>ååº”è¯¥éœ€è¦ç­‰å‡ åˆ†é’Ÿæ‰ä¼šè‡ªåŠ¨åˆ é™¤æºæ–‡ä»¶</p></blockquote></li></ul> <p><strong>åˆ‡ç‰‡æµç¨‹</strong>ï¼šRegion Split (é»˜è®¤10G)</p> <p>0.94ä¹‹å‰åˆ°è¾¾ä¹‹åæ‰ä¸”,0.94åï¼Œè‡ªåŠ¨æŒ‰ç…§ç¼“å­˜æœ€å¤§å€¼åˆ‡åˆ†ä¸º2,ä¸€ç›´ä¸‹å»ï¼Œä¼šæ“ä½œæ•°æ®å€¾æ–œé—®é¢˜,æ‰€ä»¥åœ¨å»ºè¡¨æ—¶å°±è¦åš<strong>é¢„åˆ†åŒº</strong>ã€‚</p> <p>åˆ°è¾¾å€¼,æŒ‰ç…§æ•´ä¸ªrowkeyä¸€åˆ€ä¿©æ–­</p> <blockquote><p>å®˜æ–¹å»ºè®®ï¼Œç»é‡ä½¿ç”¨ä¸€ä¸ªåˆ—æ—(ä½¿ç”¨å¤šä¸ªå°½é‡ä¿è¯æ•°æ®åŒæ­¥å¢é•¿,é˜²æ­¢å°æ–‡ä»¶)</p></blockquote> <h2 id="api"><a href="#api" class="header-anchor">#</a> API</h2> <p>è¿æ¥å¯¹è±¡:</p> <ul><li>è·å–DDLå¯¹è±¡            <strong>adminå¯¹è±¡</strong></li> <li>è·å–DMLå¯¹è±¡         <strong>tableå¯¹è±¡</strong> <ul><li>æ’å…¥æ•°æ®</li> <li>æŸ¥æ•°æ®(get)</li> <li>æŸ¥æ•°æ®(scan)</li> <li>åˆ é™¤æ•°æ®</li></ul></li></ul> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>axcmsm<span class="token punctuation">.</span>test</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>hadoop<span class="token punctuation">.</span>conf<span class="token punctuation">.</span></span><span class="token class-name">Configuration</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>hadoop<span class="token punctuation">.</span>hbase<span class="token punctuation">.</span></span><span class="token operator">*</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>hadoop<span class="token punctuation">.</span>hbase<span class="token punctuation">.</span>client<span class="token punctuation">.</span></span><span class="token operator">*</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>hadoop<span class="token punctuation">.</span>hbase<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Bytes</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">IOException</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Iterator</span><span class="token punctuation">;</span>

<span class="token comment">/*
 * DDLï¼š
 * 1åˆ¤æ–­è¡¨æ˜¯å¦å­˜åœ¨
 * 1.åˆ›å»ºè¡¨
 * 3.åˆ›å»ºå‘½åç©ºé—´
 * 4.åˆ é™¤è¡¨
 *
 * DML:
 * 1.æ’å…¥æ•°æ®
 * 2.æŸ¥æ•°æ®(get)
 * 3.æŸ¥æ•°æ®(scan)
 * 4.åˆ é™¤æ•°æ®
 *
 *
 * */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TestApi</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">Connection</span> connection <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">Admin</span> admin <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>

    <span class="token keyword">static</span> <span class="token punctuation">{</span>
        <span class="token comment">//        HBaseConfiguration conf = new HBaseConfiguration();</span>
        <span class="token class-name">Configuration</span> conf <span class="token operator">=</span> <span class="token class-name">HBaseConfiguration</span><span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//è¿æ¥zk</span>
        conf<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">&quot;hbase.zookeeper.quorum&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;hadoop111,hadoop112,hadoop113&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//        HBaseAdmin admin = new HBaseAdmin(conf);</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
<span class="token comment">//           åˆ›å»ºè¿æ¥å¯¹è±¡</span>
            connection <span class="token operator">=</span> <span class="token class-name">ConnectionFactory</span><span class="token punctuation">.</span><span class="token function">createConnection</span><span class="token punctuation">(</span>conf<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
<span class="token comment">//            åˆ›å»ºadminå¯¹è±¡</span>
            admin <span class="token operator">=</span> connection<span class="token punctuation">.</span><span class="token function">getAdmin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>


    <span class="token comment">//    1åˆ¤æ–­è¡¨æ˜¯å¦å­˜åœ¨</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">boolean</span> <span class="token function">isTablieExit</span><span class="token punctuation">(</span><span class="token class-name">String</span> tableName<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
        <span class="token keyword">boolean</span> flag <span class="token operator">=</span> admin<span class="token punctuation">.</span><span class="token function">tableExists</span><span class="token punctuation">(</span><span class="token class-name">TableName</span><span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span>tableName<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> flag<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">//å…³é—­æ–¹æ³•</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>admin <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">try</span> <span class="token punctuation">{</span>
                admin<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>connection <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">try</span> <span class="token punctuation">{</span>
                connection<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

<span class="token comment">//    åˆ›å»ºè¡¨</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">createTable</span><span class="token punctuation">(</span><span class="token class-name">String</span> tableName<span class="token punctuation">,</span><span class="token class-name">String</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> cfs<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>cfs<span class="token punctuation">.</span>length<span class="token operator">&lt;=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;è¯·è®¾ç½®åˆ—æ—ä¿¡æ¯&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isTablieExit</span><span class="token punctuation">(</span>tableName<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;è¡¨å·²ç»å­˜åœ¨&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token class-name">HTableDescriptor</span> table <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HTableDescriptor</span><span class="token punctuation">(</span><span class="token class-name">TableName</span><span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span>tableName<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//å¾ªç¯æ·»åŠ åˆ—æ—</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">String</span> cf <span class="token operator">:</span> cfs<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">//åˆ›å»ºåˆ—æ—æè¿°å™¨</span>
            <span class="token class-name">HColumnDescriptor</span> family <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HColumnDescriptor</span><span class="token punctuation">(</span>cf<span class="token punctuation">)</span><span class="token punctuation">;</span>
            table<span class="token punctuation">.</span><span class="token function">addFamily</span><span class="token punctuation">(</span>family<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//æ·»åŠ åˆ—æ—ä¿¡æ¯</span>
        <span class="token punctuation">}</span>
        admin<span class="token punctuation">.</span><span class="token function">createTable</span><span class="token punctuation">(</span>table<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">//åˆ é™¤è¡¨</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">dropTable</span><span class="token punctuation">(</span><span class="token class-name">String</span> tableName<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">isTablieExit</span><span class="token punctuation">(</span>tableName<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;ä¸å­˜åœ¨&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">//ä¸‹çº¿</span>
        admin<span class="token punctuation">.</span><span class="token function">disableTable</span><span class="token punctuation">(</span><span class="token class-name">TableName</span><span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span>tableName<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//åˆ é™¤è¡¨</span>
        admin<span class="token punctuation">.</span><span class="token function">deleteTable</span><span class="token punctuation">(</span><span class="token class-name">TableName</span><span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span>tableName<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token punctuation">}</span>
    <span class="token comment">//åˆ›å»ºå‘½åç©ºé—´</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">createNameSpace</span><span class="token punctuation">(</span><span class="token class-name">String</span> ns<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            admin<span class="token punctuation">.</span><span class="token function">createNamespace</span><span class="token punctuation">(</span><span class="token class-name">NamespaceDescriptor</span><span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>ns<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">NamespaceExistException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>e<span class="token operator">+</span><span class="token string">&quot;å‘½åç©ºé—´å·²å­˜åœ¨ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token comment">//æ’å…¥æ•°æ®</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">putData</span><span class="token punctuation">(</span><span class="token class-name">String</span> tableName<span class="token punctuation">,</span><span class="token class-name">String</span> rowKey<span class="token punctuation">,</span><span class="token class-name">String</span> cf<span class="token punctuation">,</span><span class="token class-name">String</span> cn<span class="token punctuation">,</span><span class="token class-name">String</span> value<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
        <span class="token class-name">Table</span> table <span class="token operator">=</span> connection<span class="token punctuation">.</span><span class="token function">getTable</span><span class="token punctuation">(</span><span class="token class-name">TableName</span><span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span>tableName<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Put</span> put <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Put</span><span class="token punctuation">(</span><span class="token class-name">Bytes</span><span class="token punctuation">.</span><span class="token function">toBytes</span><span class="token punctuation">(</span>rowKey<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//ä¼ å…¥rowkey</span>
        put<span class="token punctuation">.</span><span class="token function">addColumn</span><span class="token punctuation">(</span><span class="token class-name">Bytes</span><span class="token punctuation">.</span><span class="token function">toBytes</span><span class="token punctuation">(</span>cf<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">Bytes</span><span class="token punctuation">.</span><span class="token function">toBytes</span><span class="token punctuation">(</span>cn<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">Bytes</span><span class="token punctuation">.</span><span class="token function">toBytes</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        table<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>put<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//æ’å…¥æ•°æ®</span>
        <span class="token comment">//å…³é—­è¡¨è¿æ¥</span>
        table<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">//è·å–æ•°æ®</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">getData</span><span class="token punctuation">(</span><span class="token class-name">String</span> tableName<span class="token punctuation">,</span><span class="token class-name">String</span> rowKey<span class="token punctuation">,</span><span class="token class-name">String</span> cf<span class="token punctuation">,</span><span class="token class-name">String</span> cn<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
        <span class="token class-name">Table</span> table <span class="token operator">=</span> connection<span class="token punctuation">.</span><span class="token function">getTable</span><span class="token punctuation">(</span><span class="token class-name">TableName</span><span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span>tableName<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//æŒ‡å®šrowkey</span>
        <span class="token class-name">Get</span> get <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Get</span><span class="token punctuation">(</span><span class="token class-name">Bytes</span><span class="token punctuation">.</span><span class="token function">toBytes</span><span class="token punctuation">(</span>rowKey<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//        æŒ‡å®šåˆ—æ—  (ä¸æŒ‡å®šé»˜è®¤æŒ‰rowè·å–)</span>
<span class="token comment">//        get.addFamily(Bytes.toBytes(cf));</span>
        <span class="token comment">//æŒ‡å®šåˆ—æ—å’Œåˆ—</span>
        get<span class="token punctuation">.</span><span class="token function">addColumn</span><span class="token punctuation">(</span><span class="token class-name">Bytes</span><span class="token punctuation">.</span><span class="token function">toBytes</span><span class="token punctuation">(</span>cf<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token class-name">Bytes</span><span class="token punctuation">.</span><span class="token function">toBytes</span><span class="token punctuation">(</span>cn<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//è·å–æ•°æ®çš„åŠæœ¬æ•°</span>
        get<span class="token punctuation">.</span><span class="token function">setMaxVersions</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//æœ€å¤§åŠæœ¬æ•°</span>
        <span class="token comment">//  è§£æ</span>
        <span class="token class-name">Result</span> result <span class="token operator">=</span> table<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>get<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Cell</span> cell <span class="token operator">:</span> result<span class="token punctuation">.</span><span class="token function">rawCells</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;CF:&quot;</span> <span class="token operator">+</span> <span class="token class-name">Bytes</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token class-name">CellUtil</span><span class="token punctuation">.</span><span class="token function">cloneFamily</span><span class="token punctuation">(</span>cell<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span>
                    <span class="token string">&quot;, CN: &quot;</span> <span class="token operator">+</span> <span class="token class-name">Bytes</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token class-name">CellUtil</span><span class="token punctuation">.</span><span class="token function">cloneQualifier</span><span class="token punctuation">(</span>cell<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">+</span>
                    <span class="token string">&quot;, value: &quot;</span><span class="token operator">+</span><span class="token class-name">Bytes</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token class-name">CellUtil</span><span class="token punctuation">.</span><span class="token function">cloneValue</span><span class="token punctuation">(</span>cell<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        table<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">//è·å–æ•°æ®</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">scanData</span><span class="token punctuation">(</span><span class="token class-name">String</span> tableName<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
        <span class="token class-name">Table</span> table <span class="token operator">=</span> connection<span class="token punctuation">.</span><span class="token function">getTable</span><span class="token punctuation">(</span><span class="token class-name">TableName</span><span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span>tableName<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//ç©ºå‚å…¨è¡¨  å¯ä»¥ä¼ å…¥rowkey å’Œåˆ—æ— è¿˜æœ‰è¿‡æ»¤å™¨</span>
        <span class="token class-name">ResultScanner</span> scanner <span class="token operator">=</span> table<span class="token punctuation">.</span><span class="token function">getScanner</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Scan</span><span class="token punctuation">(</span><span class="token class-name">Bytes</span><span class="token punctuation">.</span><span class="token function">toBytes</span><span class="token punctuation">(</span><span class="token string">&quot;1001&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Result</span> result <span class="token operator">:</span> scanner<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">//è§£æresult</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Cell</span> cell <span class="token operator">:</span> result<span class="token punctuation">.</span><span class="token function">rawCells</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Rk:&quot;</span><span class="token operator">+</span><span class="token class-name">Bytes</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token class-name">CellUtil</span><span class="token punctuation">.</span><span class="token function">cloneRow</span><span class="token punctuation">(</span>cell<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">+</span>
                        <span class="token string">&quot;,CF:&quot;</span> <span class="token operator">+</span> <span class="token class-name">Bytes</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token class-name">CellUtil</span><span class="token punctuation">.</span><span class="token function">cloneFamily</span><span class="token punctuation">(</span>cell<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span>
                        <span class="token string">&quot;, CN: &quot;</span> <span class="token operator">+</span> <span class="token class-name">Bytes</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token class-name">CellUtil</span><span class="token punctuation">.</span><span class="token function">cloneQualifier</span><span class="token punctuation">(</span>cell<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">+</span>
                        <span class="token string">&quot;, value: &quot;</span><span class="token operator">+</span><span class="token class-name">Bytes</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token class-name">CellUtil</span><span class="token punctuation">.</span><span class="token function">cloneValue</span><span class="token punctuation">(</span>cell<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token comment">//å…³é—­è¿æ¥</span>
        table<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">//åˆ é™¤æ•°æ®</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">deleteDate</span><span class="token punctuation">(</span><span class="token class-name">String</span> tableName<span class="token punctuation">,</span><span class="token class-name">String</span> rowkey<span class="token punctuation">,</span><span class="token class-name">String</span> cf<span class="token punctuation">,</span><span class="token class-name">String</span> cn<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
        <span class="token class-name">Table</span> table <span class="token operator">=</span> connection<span class="token punctuation">.</span><span class="token function">getTable</span><span class="token punctuation">(</span><span class="token class-name">TableName</span><span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span>tableName<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// åªä¼ å…¥rk å°±ç›¸å½“äºdeleteall</span>
        <span class="token class-name">Delete</span> delete <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Delete</span><span class="token punctuation">(</span><span class="token class-name">Bytes</span><span class="token punctuation">.</span><span class="token function">toBytes</span><span class="token punctuation">(</span>rowkey<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//æŒ‡å®šåˆ—æ—ã€åˆ—åˆ é™¤æ–°ç‰ˆæœ¬   æ…ç”¨ ä½ åˆ é™¤æ–°ç‰ˆæœ¬æ—§ç‰ˆæœ¬åˆå‡ºæ¥äº†</span>
<span class="token comment">//        delete.addColumn(Bytes.toBytes(cf),Bytes.toBytes(cn));</span>
        <span class="token comment">//æŒ‡å®šåˆ—æ—ã€åˆ—åˆ é™¤å…¨éƒ¨ç‰ˆæœ¬</span>
<span class="token comment">//        delete.addColumns(Bytes.toBytes(cf),Bytes.toBytes(cn));</span>
        <span class="token comment">//æŒ‡å®šåˆ—æ—</span>
        delete<span class="token punctuation">.</span><span class="token function">addFamily</span><span class="token punctuation">(</span><span class="token class-name">Bytes</span><span class="token punctuation">.</span><span class="token function">toBytes</span><span class="token punctuation">(</span>cf<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        table<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span>delete<span class="token punctuation">)</span><span class="token punctuation">;</span>
        table<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
<span class="token comment">//        System.out.println(&quot;------------------&quot;);</span>
<span class="token comment">////        System.out.println(isTablieExit(&quot;0408:stu5&quot;));</span>
<span class="token comment">//        System.out.println(&quot;------------------&quot;);</span>
        <span class="token comment">//åˆ›å»ºè¡¨æµ‹è¯•</span>
<span class="token comment">//        createTable(&quot;0408:stu5&quot;,&quot;info1&quot;,&quot;info2&quot;);</span>
<span class="token comment">//        createTable(&quot;0408:stu5&quot;,&quot;info1&quot;);</span>
        <span class="token comment">//åˆ é™¤è¡¨</span>
<span class="token comment">//        dropTable(&quot;0408:stu5&quot;);</span>
<span class="token comment">//        //åˆ›å»ºå‘½åç©ºé—´</span>
<span class="token comment">////        createNameSpace(&quot;0408&quot;);</span>

<span class="token comment">////        æ’å…¥æ•°æ®æµ‹è¯•</span>
<span class="token comment">//        putData(&quot;0408:stu5&quot;,&quot;1001&quot;,&quot;info1&quot;,&quot;name&quot;,&quot;lisi&quot;);</span>
<span class="token comment">//        putData(&quot;0408:stu5&quot;,&quot;1001&quot;,&quot;info1&quot;,&quot;age&quot;,&quot;12&quot;);</span>
<span class="token comment">//        //è·å–å•è¡Œæ•°æ®</span>
<span class="token comment">//        getData(&quot;0408:stu5&quot;,&quot;1001&quot;,&quot;info1&quot;,&quot;name&quot;);</span>
        <span class="token comment">//è·å–å…¨è¡¨æ•°æ®</span>
        <span class="token function">scanData</span><span class="token punctuation">(</span><span class="token string">&quot;0408:stu5&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;------------------&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//        System.out.println(isTablieExit(&quot;0408:stu5&quot;));</span>
<span class="token comment">//        System.out.println(&quot;------------------&quot;);</span>

    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br><span class="line-number">147</span><br><span class="line-number">148</span><br><span class="line-number">149</span><br><span class="line-number">150</span><br><span class="line-number">151</span><br><span class="line-number">152</span><br><span class="line-number">153</span><br><span class="line-number">154</span><br><span class="line-number">155</span><br><span class="line-number">156</span><br><span class="line-number">157</span><br><span class="line-number">158</span><br><span class="line-number">159</span><br><span class="line-number">160</span><br><span class="line-number">161</span><br><span class="line-number">162</span><br><span class="line-number">163</span><br><span class="line-number">164</span><br><span class="line-number">165</span><br><span class="line-number">166</span><br><span class="line-number">167</span><br><span class="line-number">168</span><br><span class="line-number">169</span><br><span class="line-number">170</span><br><span class="line-number">171</span><br><span class="line-number">172</span><br><span class="line-number">173</span><br><span class="line-number">174</span><br><span class="line-number">175</span><br><span class="line-number">176</span><br><span class="line-number">177</span><br><span class="line-number">178</span><br><span class="line-number">179</span><br><span class="line-number">180</span><br><span class="line-number">181</span><br><span class="line-number">182</span><br><span class="line-number">183</span><br><span class="line-number">184</span><br><span class="line-number">185</span><br><span class="line-number">186</span><br><span class="line-number">187</span><br><span class="line-number">188</span><br><span class="line-number">189</span><br><span class="line-number">190</span><br><span class="line-number">191</span><br><span class="line-number">192</span><br><span class="line-number">193</span><br><span class="line-number">194</span><br><span class="line-number">195</span><br><span class="line-number">196</span><br><span class="line-number">197</span><br><span class="line-number">198</span><br><span class="line-number">199</span><br><span class="line-number">200</span><br><span class="line-number">201</span><br><span class="line-number">202</span><br><span class="line-number">203</span><br><span class="line-number">204</span><br><span class="line-number">205</span><br><span class="line-number">206</span><br><span class="line-number">207</span><br><span class="line-number">208</span><br><span class="line-number">209</span><br></div></div><blockquote><p>æ‰©å±•ï¼šdeleteåˆ é™¤å®é™…ä¸Šä¹Ÿæ˜¯putæ“ä½œ,ä»–ç»™æ•°æ®putä¸€ä¸ªæ ‡è®°æ˜¾ç¤ºä¸ºåˆ é™¤</p></blockquote> <h3 id="æ•´åˆmr"><a href="#æ•´åˆmr" class="header-anchor">#</a> æ•´åˆMR</h3> <p><strong>æ­¥éª¤</strong>ï¼š</p> <ol><li><p>æŸ¥çœ‹hbaseçš„mrä»»åŠ¡æ‰§è¡Œå‘½ä»¤      (rmè¦æ“ä½œhbseå¿…é¡»è¦æŒæœ‰è¿™äº›jaråŒ…)</p> <p>åœ¨hbase2.0åè¦å°†hbase-mapreduceä¹Ÿæ·»åŠ åˆ°pomä¾èµ–å³å¯</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>bin/hbase mapredcp <span class="token comment">#æ˜¾ç¤ºæ‰§è¡Œçš„jaråŒ…</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p>é…ç½®ç¯å¢ƒå˜é‡  åœ¨hadoop-env.sh</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment"># é…ç½®mræ•´åˆåˆ°hbase</span>
<span class="token builtin class-name">export</span> <span class="token assign-left variable">HADOOP_CLASSPATH</span><span class="token operator">=</span><span class="token variable">$HADOOP_CLASSPATH</span>:/opt/module/hbase/lib/*
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>åˆ†å‘ é‡å¯</p></li> <li><p>è¿è¡Œå®˜æ–¹æ¡ˆä¾‹</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment">#ç»Ÿè®¡æ¡æ•°</span>
/opt/module/hadoop-3.1.4/bin/yarn jar lib/hbase-server-1.3.1.jar rowcounter stu
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment">#mræœ¬åœ°æ•°æ®å¯¼å…¥åˆ° HBase</span>
/opt/module/hadoop-3.1.4/bin/yarn jar lib/hbase-server-1.3.1.jar importtsv  -Dimporttsv.columns<span class="token operator">=</span>HBASE_ROW_KEY,info:name,info:color fruit hdfs://hadoop111:9000/fruit.tsv
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></li></ol> <h3 id="æ•´åˆhive"><a href="#æ•´åˆhive" class="header-anchor">#</a> æ•´åˆHive</h3> <p><strong>hbaseå’Œhiveæ¯”è¾ƒ</strong>ï¼š</p> <p>habaseæ˜¯ç”¨æ¥å­˜å‚¨æ•°æ®çš„,<strong>é¢å‘åˆ—æ—å­˜å‚¨</strong>çš„éå…³ç³»å‹æ•°æ®åº“,å­˜å‚¨ç»“æ„åŒ–å’Œéç»“æ„åŒ–çš„æ•°æ®,é€‚ç”¨äºå•è¡¨æŸ¥è¯¢,åŸºäºhdfs,å»¶è¿Ÿä½,æ¥å…¥åœ¨çº¿ä¸šåŠ¡é€‚ç”¨(ç±»ä¼¼ esã€redis)</p> <p>Hiveæ˜¯åˆ†ææ¸…æ´—æ•°æ®çš„,åšæ•°æ®ä»“åº“ã€‚</p> <p><strong>æ­¥éª¤</strong>ï¼š</p> <ul><li><p>é…ç½®ç¯å¢ƒ (ä¹Ÿå¯ä»¥è®¾ç½®ä¸´æ—¶)</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>export HBASE_HOME=/opt/module/hbase
export HIVE_HOME=/opt/module/hive312
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></li> <li><p>åˆ›å»ºè½¯é“¾æ¥</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>ln -s $HBASE_HOME/lib/hbase-common-1.3.1.jar $HIVE_HOME/lib/hbase-common-1.3.1.jar
ln -s $HBASE_HOME/lib/hbase-server-1.3.1.jar $HIVE_HOME/lib/hbase-server-1.3.1.jar
ln -s $HBASE_HOME/lib/hbase-client-1.3.1.jar $HIVE_HOME/lib/hbase-client-1.3.1.jar
ln -s $HBASE_HOME/lib/hbase-protocol-1.3.1.jar $HIVE_HOME/lib/hbase-protocol-1.3.1.jar
ln -s $HBASE_HOME/lib/hbase-it-1.3.1.jar $HIVE_HOME/lib/hbase-it-1.3.1.jar
ln -s $HBASE_HOME/lib/htrace-core-3.1.0-incubating.jar $HIVE_HOME/lib/htrace-core-3.1.0-incubating.jar
ln -s $HBASE_HOME/lib/hbase-hadoop2-compat-1.3.1.jar $HIVE_HOME/lib/hbase-hadoop2-compat-1.3.1.jar
ln -s $HBASE_HOME/lib/hbase-hadoop-compat-1.3.1.jar $HIVE_HOME/lib/hbase-hadoop-compat-1.3.1.jar
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div></li> <li><p>åœ¨hive-site.xmlä¸­ä¿®æ”¹zkå±æ€§</p> <div class="language-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>hive.zookeeper.quorum<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>hadoop111,hadoop112,hadoop113<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>description</span><span class="token punctuation">&gt;</span></span>The list of ZooKeeper servers to talk to. This is 
only needed for read/write locks.<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>description</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>hive.zookeeper.client.port<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>2181<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>description</span><span class="token punctuation">&gt;</span></span>The port of ZooKeeper servers to talk to. This is 
only needed for read/write locks.<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>description</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div></li></ul> <h2 id="ä¼˜åŒ–"><a href="#ä¼˜åŒ–" class="header-anchor">#</a> ä¼˜åŒ–</h2> <p><strong>é«˜å¯ç”¨</strong>ï¼šè‡ªå¸¦é«˜å¯ç”¨</p> <p><strong>é¢„åˆ†åŒº</strong>ï¼šæ•°æ®é‡(æœªæ¥åŠå¹´ä¸€å¹´)ã€æœºå™¨è§„æ¨¡</p> <ul><li><p>æ‰‹åŠ¨è®¾å®šé¢„åˆ†åŒº</p></li> <li><p>ç”Ÿæˆ 16 è¿›åˆ¶åºåˆ—é¢„åˆ†åŒº</p></li> <li><p>æŒ‰ç…§æ–‡ä»¶ä¸­è®¾ç½®çš„è§„åˆ™é¢„åˆ†åŒº <code>create 'staff3','partition3',SPLITS_FILE =&gt; 'splits.txt'</code></p></li> <li><p>ä½¿ç”¨javaApiåˆ›å»ºé¢„åˆ†åŒº</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">//è‡ªå®šä¹‰ç®—æ³•ï¼Œäº§ç”Ÿä¸€ç³»åˆ— hash æ•£åˆ—å€¼å­˜å‚¨åœ¨äºŒç»´æ•°ç»„ä¸­</span>
<span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span> splitKeys <span class="token operator">=</span> æŸä¸ªæ•£åˆ—å€¼å‡½æ•°
<span class="token comment">//åˆ›å»º HbaseAdmin å®ä¾‹</span>
<span class="token class-name">HBaseAdmin</span> hAdmin <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HBaseAdmin</span><span class="token punctuation">(</span><span class="token class-name">HbaseConfiguration</span><span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//åˆ›å»º HTableDescriptor å®ä¾‹</span>
<span class="token class-name">HTableDescriptor</span> tableDesc <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HTableDescriptor</span><span class="token punctuation">(</span>tableName<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//é€šè¿‡ HTableDescriptor å®ä¾‹å’Œæ•£åˆ—å€¼äºŒç»´æ•°ç»„åˆ›å»ºå¸¦æœ‰é¢„åˆ†åŒºçš„ Hbase è¡¨</span>
hAdmin<span class="token punctuation">.</span><span class="token function">createTable</span><span class="token punctuation">(</span>tableDesc<span class="token punctuation">,</span> splitKeys<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div></li></ul> <p><strong>RowKeyè®¾è®¡</strong>:å°½é‡å‡åŒ€æ•£è½åœ¨æ¯ä¸ª<strong>åˆ†åŒº</strong></p> <p>(<strong>æ•£åˆ—æ€§</strong>,<strong>å”¯ä¸€æ€§</strong>,<strong>é•¿åº¦åŸåˆ™</strong>(70-100))</p> <ul><li>ç”Ÿäº§éšæœºæ•°ã€hashã€æ•£åˆ—å€¼</li> <li>å­—ç¬¦åè½¬</li> <li>å­—ç¬¦ä¸²æ‹¼æ¥</li></ul> <p><strong>å†…å­˜ä¼˜åŒ–</strong>ï¼šä¸å»ºè®®åˆ†é…éå¸¸å¤§çš„å †å†…å­˜</p> <p><strong>åŸºç¡€ä¼˜åŒ–</strong>ï¼š</p> <ul><li>å…è®¸åœ¨hdfsæ–‡ä»¶ä¸­è¿½åŠ å†…å®¹</li> <li>ä¼˜åŒ–datanodeå…è®¸çš„æœ€å¤§æ–‡ä»¶æ‰“å¼€æ•°</li> <li>ä¼˜åŒ–å»¶è¿Ÿé«˜çš„æ•°æ®æ“ä½œçš„ç­‰å¾…æ—¶é—´</li> <li>ä¼˜åŒ–æ•°æ®çš„å†™å…¥æ•ˆç‡</li> <li>è®¾ç½®rpcç›‘å¬æ•°é‡</li> <li>ä¼˜åŒ–hstoræ–‡ä»¶å¤§å°</li> <li>ä¼˜åŒ–hbaseå®¢æˆ·ç«¯ç¼“å­˜</li> <li>æŒ‡å®šscan.nextæ‰«ææ‰€è·å–çš„è¡Œæ•°</li> <li>flushã€compactã€splitæœºåˆ¶</li></ul> <p>kylinå¯ä»¥åšé¢„å¤„ç†æŸ¥è¯¢åˆ†æhiveçš„ç»“æœå­˜å‚¨åˆ°hbaseåˆ°æ—¶å°±å¯ä»¥ç›´æ¥æŸ¥ã€‚</p> <h2 id="è¸©å‘"><a href="#è¸©å‘" class="header-anchor">#</a> è¸©å‘</h2> <p>hadoopä¸­core-site.xmlå’Œmasterç«¯å£ä¸ä¸€è‡´é—®é¢˜</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>master.HMaster: Failed to become active master
java.net.ConnectException: Call From axcmsm111/192.168.67.111 to hadoop111:9000 failed on connection exception: java.net.ConnectException: æ‹’ç»è¿æ¥; For more details see:  http://wiki.apache.org/hadoop/ConnectionRefused
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>åœ¨hadoopçš„core-site.xml ä¸­æ·»åŠ ä»¥ä¸‹å†…å®¹</p> <div class="language-xml line-numbers-mode"><pre class="language-xml"><code><span class="token comment">&lt;!-- æ•´åˆ Hbase --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">&gt;</span></span>fs.defaultFS<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>value</span><span class="token punctuation">&gt;</span></span>hdfs://hadoop111:9000/HBase<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>value</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>åˆ†å‘é…ç½®æ–‡ä»¶</p> <p>é‡å¯hadoopé›†ç¾¤</p></div> <footer class="page-edit" style="display:none;"><!----> <div class="last-updated"><span class="prefix">Last Updated: </span> <span class="time">2021/9/21 ä¸‹åˆ11:14:17</span></div></footer> <!----> <!----> <!----></main> <!----></div></div></div></div></div><div class="global-ui"><div class="back-to-ceiling" style="right:1rem;bottom:6rem;width:2.5rem;height:2.5rem;border-radius:.25rem;line-height:2.5rem;display:none;" data-v-c6073ba8 data-v-c6073ba8><svg t="1574745035067" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5404" class="icon" data-v-c6073ba8><path d="M526.60727968 10.90185116a27.675 27.675 0 0 0-29.21455937 0c-131.36607665 82.28402758-218.69155461 228.01873535-218.69155402 394.07834331a462.20625001 462.20625001 0 0 0 5.36959153 69.94390903c1.00431239 6.55289093-0.34802892 13.13561351-3.76865779 18.80351572-32.63518765 54.11355614-51.75690182 118.55860487-51.7569018 187.94566865a371.06718723 371.06718723 0 0 0 11.50484808 91.98906777c6.53300375 25.50556257 41.68394495 28.14064038 52.69160883 4.22606766 17.37162448-37.73630017 42.14135425-72.50938081 72.80769204-103.21549295 2.18761121 3.04276886 4.15646224 6.24463696 6.40373557 9.22774369a1871.4375 1871.4375 0 0 0 140.04691725 5.34970492 1866.36093723 1866.36093723 0 0 0 140.04691723-5.34970492c2.24727335-2.98310674 4.21612437-6.18497483 6.3937923-9.2178004 30.66633723 30.70611158 55.4360664 65.4791928 72.80769147 103.21549355 11.00766384 23.91457269 46.15860503 21.27949489 52.69160879-4.22606768a371.15156223 371.15156223 0 0 0 11.514792-91.99901164c0-69.36717486-19.13165746-133.82216804-51.75690182-187.92578088-3.42062944-5.66790279-4.76302748-12.26056868-3.76865837-18.80351632a462.20625001 462.20625001 0 0 0 5.36959269-69.943909c-0.00994388-166.08943902-87.32547796-311.81420293-218.6915546-394.09823051zM605.93803103 357.87693858a93.93749974 93.93749974 0 1 1-187.89594924 6.1e-7 93.93749974 93.93749974 0 0 1 187.89594924-6.1e-7z" p-id="5405" data-v-c6073ba8></path><path d="M429.50777625 765.63860547C429.50777625 803.39355007 466.44236686 1000.39046097 512.00932183 1000.39046097c45.56695499 0 82.4922232-197.00623328 82.5015456-234.7518555 0-37.75494459-36.9345906-68.35043303-82.4922232-68.34111062-45.57627738-0.00932239-82.52019037 30.59548842-82.51086798 68.34111062z" p-id="5406" data-v-c6073ba8></path></svg></div><!----></div></div>
    <script src="/assets/js/app.7036e47e.js" defer></script><script src="/assets/js/4.ec8df83f.js" defer></script><script src="/assets/js/1.d2920358.js" defer></script><script src="/assets/js/2.245be42e.js" defer></script><script src="/assets/js/44.6e407d3e.js" defer></script><script src="/assets/js/12.44af248e.js" defer></script>
  </body>
</html>
