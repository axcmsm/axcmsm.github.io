<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Pandas | 须贺</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="/img/favicon.ico">
    <script>
          var _hmt = _hmt || [];
          (function() {
            var hm = document.createElement("script");
            hm.src = "https://hm.baidu.com/hm.js?9146a86d484b79eb7a9fab54d0655aa0";
            var s = document.getElementsByTagName("script")[0]; 
            s.parentNode.insertBefore(hm, s);
          })();
        </script>
    <script language="javascript" type="text/javascript" src="https://cdn.bootcdn.net/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script language="javascript" type="text/javascript" src="/js/MouseClickEffect.js"></script>
    <meta name="description" content="《鸟欲高飞先展翅，人求上进先读书》">
    <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no">
    
    <link rel="preload" href="/assets/css/0.styles.c55ec633.css" as="style"><link rel="preload" href="/assets/js/app.7036e47e.js" as="script"><link rel="preload" href="/assets/js/4.ec8df83f.js" as="script"><link rel="preload" href="/assets/js/1.d2920358.js" as="script"><link rel="preload" href="/assets/js/2.245be42e.js" as="script"><link rel="preload" href="/assets/js/58.95fa43c5.js" as="script"><link rel="preload" href="/assets/js/12.44af248e.js" as="script"><link rel="prefetch" href="/assets/js/10.a2ab4732.js"><link rel="prefetch" href="/assets/js/11.cb2a446e.js"><link rel="prefetch" href="/assets/js/13.fe5d2510.js"><link rel="prefetch" href="/assets/js/14.a86b66a0.js"><link rel="prefetch" href="/assets/js/15.db93f4b6.js"><link rel="prefetch" href="/assets/js/16.315be0a7.js"><link rel="prefetch" href="/assets/js/17.bb33c2d3.js"><link rel="prefetch" href="/assets/js/18.aa3bc2d5.js"><link rel="prefetch" href="/assets/js/19.eb6674e0.js"><link rel="prefetch" href="/assets/js/20.26398a86.js"><link rel="prefetch" href="/assets/js/21.8573d310.js"><link rel="prefetch" href="/assets/js/22.f39eb1c6.js"><link rel="prefetch" href="/assets/js/23.70b63e87.js"><link rel="prefetch" href="/assets/js/24.780f4265.js"><link rel="prefetch" href="/assets/js/25.087b890e.js"><link rel="prefetch" href="/assets/js/26.a3432377.js"><link rel="prefetch" href="/assets/js/27.c82078d0.js"><link rel="prefetch" href="/assets/js/28.3f62dff1.js"><link rel="prefetch" href="/assets/js/29.c935e9bc.js"><link rel="prefetch" href="/assets/js/30.4acfb7de.js"><link rel="prefetch" href="/assets/js/31.3bd52897.js"><link rel="prefetch" href="/assets/js/32.cd6a4df7.js"><link rel="prefetch" href="/assets/js/33.4f206021.js"><link rel="prefetch" href="/assets/js/34.ad299da7.js"><link rel="prefetch" href="/assets/js/35.a74cd3c6.js"><link rel="prefetch" href="/assets/js/36.a6d81e30.js"><link rel="prefetch" href="/assets/js/37.e3323ce2.js"><link rel="prefetch" href="/assets/js/38.18d7dd67.js"><link rel="prefetch" href="/assets/js/39.833f42ab.js"><link rel="prefetch" href="/assets/js/40.ed6400f3.js"><link rel="prefetch" href="/assets/js/41.81e6fc53.js"><link rel="prefetch" href="/assets/js/42.d0e39d51.js"><link rel="prefetch" href="/assets/js/43.047ac597.js"><link rel="prefetch" href="/assets/js/44.6e407d3e.js"><link rel="prefetch" href="/assets/js/45.234ad067.js"><link rel="prefetch" href="/assets/js/46.3eaaa14c.js"><link rel="prefetch" href="/assets/js/47.cd7ab522.js"><link rel="prefetch" href="/assets/js/48.d146214c.js"><link rel="prefetch" href="/assets/js/49.5412d8fd.js"><link rel="prefetch" href="/assets/js/5.83420c85.js"><link rel="prefetch" href="/assets/js/50.361271e2.js"><link rel="prefetch" href="/assets/js/51.2488c147.js"><link rel="prefetch" href="/assets/js/52.a5eb5e9f.js"><link rel="prefetch" href="/assets/js/53.c3859002.js"><link rel="prefetch" href="/assets/js/54.c572a44d.js"><link rel="prefetch" href="/assets/js/55.30248800.js"><link rel="prefetch" href="/assets/js/56.248288b0.js"><link rel="prefetch" href="/assets/js/57.3a11d1c7.js"><link rel="prefetch" href="/assets/js/59.d002a857.js"><link rel="prefetch" href="/assets/js/6.5faf5a50.js"><link rel="prefetch" href="/assets/js/60.26b4ef39.js"><link rel="prefetch" href="/assets/js/61.7c152e5e.js"><link rel="prefetch" href="/assets/js/62.baeb52bb.js"><link rel="prefetch" href="/assets/js/63.8978958b.js"><link rel="prefetch" href="/assets/js/64.b14585b3.js"><link rel="prefetch" href="/assets/js/7.13c62f03.js"><link rel="prefetch" href="/assets/js/8.b2b362e0.js"><link rel="prefetch" href="/assets/js/9.0fd0389d.js">
    <link rel="stylesheet" href="/assets/css/0.styles.c55ec633.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container no-sidebar" data-v-faf1ae92><div data-v-faf1ae92><div id="loader-wrapper" class="loading-wrapper" data-v-d48f4d20 data-v-faf1ae92 data-v-faf1ae92><div class="loader-main" data-v-d48f4d20><div data-v-d48f4d20></div><div data-v-d48f4d20></div><div data-v-d48f4d20></div><div data-v-d48f4d20></div></div> <!----> <!----></div> <div class="password-shadow password-wrapper-out" style="display:none;" data-v-5cb9a64e data-v-faf1ae92 data-v-faf1ae92><h3 class="title" style="display:none;" data-v-5cb9a64e data-v-5cb9a64e>须贺</h3> <!----> <label id="box" class="inputBox" style="display:none;" data-v-5cb9a64e data-v-5cb9a64e><input type="password" value="" data-v-5cb9a64e> <span data-v-5cb9a64e>Konck! Knock!</span> <button data-v-5cb9a64e>OK</button></label> <div class="footer" style="display:none;" data-v-5cb9a64e data-v-5cb9a64e><span data-v-5cb9a64e><i class="iconfont reco-theme" data-v-5cb9a64e></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-5cb9a64e>vuePress-theme-reco</a></span> <span data-v-5cb9a64e><i class="iconfont reco-copyright" data-v-5cb9a64e></i> <a data-v-5cb9a64e><span data-v-5cb9a64e>🎈</span>
            
          <span data-v-5cb9a64e>2021 - </span>
          2023
        </a></span></div></div> <div class="hide" data-v-faf1ae92><div data-v-faf1ae92><div id="smart" class="wrapper-page" style="background-image:url(/img/bjt3.jpg);background-position-x:center;background-position-y:center;background-size:cover;background-repeat-x:no-repeat;background-repeat-y:no-repeat;" data-v-faf1ae92><header class="navbar" data-v-faf1ae92><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/img/favicon.ico" alt="须贺" class="logo"> <span class="site-name">须贺</span></a> <div class="links"><div id="dayNightSwitch" class="generalWrapper" data-v-32f44868><a class="click" data-v-32f44868><div class="onOff daySwitch" data-v-32f44868><div class="star star1" data-v-32f44868></div> <div class="star star2" data-v-32f44868></div> <div class="star star3" data-v-32f44868></div> <div class="star star4" data-v-32f44868></div> <div class="star star5" data-v-32f44868></div> <div class="star sky" data-v-32f44868></div> <div class="sunMoon" data-v-32f44868><div class="crater crater1" data-v-32f44868></div> <div class="crater crater2" data-v-32f44868></div> <div class="crater crater3" data-v-32f44868></div> <div class="cloud part1" data-v-32f44868></div> <div class="cloud part2" data-v-32f44868></div></div></div></a></div> <div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link"><i class="iconfont reco-home"></i>
  主页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-category"></i>
      分类
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/java/" class="nav-link"><i class="iconfont undefined"></i>
  java
</a></li><li class="dropdown-item"><!----> <a href="/categories/其他/" class="nav-link"><i class="iconfont undefined"></i>
  其他
</a></li><li class="dropdown-item"><!----> <a href="/categories/收藏/" class="nav-link"><i class="iconfont undefined"></i>
  收藏
</a></li><li class="dropdown-item"><!----> <a href="/categories/前端/" class="nav-link"><i class="iconfont undefined"></i>
  前端
</a></li><li class="dropdown-item"><!----> <a href="/categories/安装/" class="nav-link"><i class="iconfont undefined"></i>
  安装
</a></li><li class="dropdown-item"><!----> <a href="/categories/笔记/" class="nav-link"><i class="iconfont undefined"></i>
  笔记
</a></li><li class="dropdown-item"><!----> <a href="/categories/踩坑/" class="nav-link"><i class="iconfont undefined"></i>
  踩坑
</a></li></ul></div></div><div class="nav-item"><a href="/tag/" class="nav-link"><i class="iconfont reco-tag"></i>
  标签
</a></div><div class="nav-item"><a href="/timeline/" class="nav-link"><i class="iconfont reco-date"></i>
  时间轴
</a></div><div class="nav-item"><a href="/view/reward/" class="nav-link"><i class="iconfont undefined"></i>
  奖励
</a></div><div class="nav-item"><a href="/about/" class="nav-link"><i class="iconfont reco-account"></i>
  关于
</a></div> <!----></nav></div></header> <div class="sidebar-mask" data-v-faf1ae92></div> <aside class="sidebar" data-v-faf1ae92><div class="personal-info-wrapper" data-v-03833281 data-v-faf1ae92><img src="/img/author.png" alt="author-avatar" class="personal-img" data-v-03833281> <h3 class="name" data-v-03833281>
    🎈
  </h3> <div class="num" data-v-03833281><div data-v-03833281><h3 data-v-03833281>43</h3> <h6 data-v-03833281>文章</h6></div> <div data-v-03833281><h3 data-v-03833281>32</h3> <h6 data-v-03833281>标签</h6></div></div> <hr data-v-03833281></div> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link"><i class="iconfont reco-home"></i>
  主页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-category"></i>
      分类
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/java/" class="nav-link"><i class="iconfont undefined"></i>
  java
</a></li><li class="dropdown-item"><!----> <a href="/categories/其他/" class="nav-link"><i class="iconfont undefined"></i>
  其他
</a></li><li class="dropdown-item"><!----> <a href="/categories/收藏/" class="nav-link"><i class="iconfont undefined"></i>
  收藏
</a></li><li class="dropdown-item"><!----> <a href="/categories/前端/" class="nav-link"><i class="iconfont undefined"></i>
  前端
</a></li><li class="dropdown-item"><!----> <a href="/categories/安装/" class="nav-link"><i class="iconfont undefined"></i>
  安装
</a></li><li class="dropdown-item"><!----> <a href="/categories/笔记/" class="nav-link"><i class="iconfont undefined"></i>
  笔记
</a></li><li class="dropdown-item"><!----> <a href="/categories/踩坑/" class="nav-link"><i class="iconfont undefined"></i>
  踩坑
</a></li></ul></div></div><div class="nav-item"><a href="/tag/" class="nav-link"><i class="iconfont reco-tag"></i>
  标签
</a></div><div class="nav-item"><a href="/timeline/" class="nav-link"><i class="iconfont reco-date"></i>
  时间轴
</a></div><div class="nav-item"><a href="/view/reward/" class="nav-link"><i class="iconfont undefined"></i>
  奖励
</a></div><div class="nav-item"><a href="/about/" class="nav-link"><i class="iconfont reco-account"></i>
  关于
</a></div> <!----></nav> <!----> </aside> <div class="password-shadow password-wrapper-in" style="display:none;" data-v-5cb9a64e data-v-faf1ae92><h3 class="title" style="display:none;" data-v-5cb9a64e data-v-5cb9a64e></h3> <!----> <label id="box" class="inputBox" style="display:none;" data-v-5cb9a64e data-v-5cb9a64e><input type="password" value="" data-v-5cb9a64e> <span data-v-5cb9a64e>Konck! Knock!</span> <button data-v-5cb9a64e>OK</button></label> <div class="footer" style="display:none;" data-v-5cb9a64e data-v-5cb9a64e><span data-v-5cb9a64e><i class="iconfont reco-theme" data-v-5cb9a64e></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-5cb9a64e>vuePress-theme-reco</a></span> <span data-v-5cb9a64e><i class="iconfont reco-copyright" data-v-5cb9a64e></i> <a data-v-5cb9a64e><span data-v-5cb9a64e>🎈</span>
            
          <span data-v-5cb9a64e>2021 - </span>
          2023
        </a></span></div></div></div> <div data-v-faf1ae92><main class="page"><div class="page-title" style="display:none;"><h1 class="title">Pandas</h1> <div class="page-info" data-v-0efa1f05><i class="iconfont reco-account" data-v-0efa1f05><span data-v-0efa1f05>🎈</span></i> <!----> <i class="iconfont reco-eye" data-v-0efa1f05><span id="/view/docs/%E7%AC%94%E8%AE%B0/Pandas.html" data-flag-title="Your Article Title" class="leancloud-visitors" data-v-0efa1f05><a class="leancloud-visitors-count" style="font-size:.9rem;font-weight:normal;color:#999;"></a></span></i> <!----></div></div> <div class="theme-reco-content content__default" style="display:none;"><h2 id="pandas"><a href="#pandas" class="header-anchor">#</a> Pandas</h2> <h2 id="读取数据文件"><a href="#读取数据文件" class="header-anchor">#</a> <strong>读取数据文件</strong></h2> <ul><li>纯文本 csv，txt</li> <li>slsx格式的execl文件</li> <li>mysql数据表</li></ul> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token comment">#csv</span>
r<span class="token operator">=</span>pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span>路径<span class="token punctuation">,</span>sep<span class="token operator">=</span>分隔符，header<span class="token operator">=</span>标题行<span class="token punctuation">,</span>names<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">&quot;列名1&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;列名2&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;列名3&quot;</span><span class="token punctuation">]</span>，skiprows<span class="token operator">=</span><span class="token string">'第几行开始读取'</span><span class="token punctuation">)</span>
r<span class="token punctuation">.</span>head<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">#前5行</span>
r<span class="token punctuation">.</span>shape<span class="token comment">#查看数据形状(行，列)</span>
r<span class="token punctuation">.</span>columns<span class="token comment">#查看数据的列名</span>
r<span class="token punctuation">.</span>index<span class="token comment">#查看数据的索引</span>
r<span class="token punctuation">.</span>dtypes<span class="token comment">#数据类型</span>
r<span class="token punctuation">.</span>set_index<span class="token punctuation">(</span>列，inplace<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token comment">#设置索引</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token comment">#execl</span>
r<span class="token operator">=</span>pd<span class="token punctuation">.</span>read_excel<span class="token punctuation">(</span>path<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token comment">#mysql</span>
<span class="token keyword">import</span> pymysql
conn<span class="token operator">=</span>pymysql<span class="token punctuation">.</span>connect<span class="token punctuation">(</span>host<span class="token punctuation">,</span>user<span class="token punctuation">,</span>password<span class="token punctuation">,</span>database<span class="token punctuation">,</span>charset<span class="token operator">=</span><span class="token string">'utf8'</span><span class="token punctuation">)</span>
r<span class="token operator">=</span>pd<span class="token punctuation">.</span>read_sql<span class="token punctuation">(</span><span class="token string">&quot;select * from table&quot;</span><span class="token punctuation">,</span>con<span class="token operator">=</span>conn<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h2 id="数据结构"><a href="#数据结构" class="header-anchor">#</a> 数据结构</h2> <ul><li><p>DataFrame：二维数据,整个表，多行多列=&gt; df.index ,df.columns</p> <blockquote><p>表类型数据结构：</p> <ul><li>每列可有不同的值类型(数值，字符串，布尔值)</li> <li>既有行索引index,也有列索引coumns</li> <li>可以被看做由Series组成的字典</li></ul></blockquote></li> <li><p>Series：一维数据，一行或一列</p> <blockquote><p>类似一维数组对象，由一组不同数据类型以及索引组成。</p></blockquote></li></ul> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token comment">#series</span>
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
<span class="token keyword">import</span> pandas <span class="token keyword">as</span> np

<span class="token comment">#创建简单的Series</span>
r<span class="token operator">=</span>pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">'a'</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">42</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment">#r.index 索引 r.values值</span>
<span class="token comment">#创建Series指定索引</span>
r<span class="token operator">=</span>pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">'a'</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">42</span><span class="token punctuation">]</span><span class="token punctuation">,</span>index<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span><span class="token string">'b'</span><span class="token punctuation">,</span><span class="token string">'v'</span><span class="token punctuation">,</span><span class="token string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token comment">#使用python字典创建Series</span>
r<span class="token operator">=</span>pd<span class="token punctuation">.</span>Series<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&quot;a&quot;</span><span class="token punctuation">:</span><span class="token number">123</span><span class="token punctuation">,</span><span class="token string">&quot;b&quot;</span><span class="token punctuation">:</span><span class="token number">245</span><span class="token punctuation">,</span><span class="token string">&quot;c&quot;</span><span class="token punctuation">:</span><span class="token number">222</span><span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">#访问</span>
r<span class="token punctuation">[</span>索引<span class="token punctuation">]</span>
r<span class="token punctuation">[</span><span class="token punctuation">[</span>索引<span class="token number">1</span>，索引<span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token comment">#多个</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token comment">#创建dataframe=&gt;读取exect csv msql</span>
<span class="token comment">#多个字典创建</span>
df<span class="token operator">=</span>pd<span class="token punctuation">.</span>DataFrame<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">'add'</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token number">1</span>，<span class="token number">1</span>，<span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token string">'bbb'</span><span class="token punctuation">:</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token comment">#df.index df.columns</span>

<span class="token comment">#查询</span>
    <span class="token comment">#查询列</span>
    df<span class="token punctuation">[</span><span class="token string">'add'</span><span class="token punctuation">]</span><span class="token comment">#一个series</span>
    df<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'add'</span><span class="token punctuation">,</span><span class="token string">'bbb'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token comment">#多列还是df</span>

    <span class="token comment">#查询行</span>
    df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token comment">#查询一行</span>
    df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token comment">#查询多行还是df</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h2 id="数据查询"><a href="#数据查询" class="header-anchor">#</a> 数据查询</h2> <blockquote><p>数值、列表、区间、条件、函数</p></blockquote> <p><strong>方法</strong>:</p> <ul><li>df.loc：根据行、列标签值查询 =&gt;既能查询又能覆盖写入</li> <li>df.iloc：根据行、列的数值位置查询</li> <li>df.where</li> <li>df.query</li></ul> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token comment">#df.loc</span>
<span class="token number">1</span><span class="token punctuation">.</span> 使用单个label值进行查询
	df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token string">'索引'</span><span class="token punctuation">,</span><span class="token string">&quot;列名&quot;</span><span class="token punctuation">]</span><span class="token comment">#查询单个值</span>
    df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token string">&quot;索引&quot;</span>，<span class="token punctuation">[</span><span class="token string">&quot;列名1&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;列名2&quot;</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token comment">#得到Series</span>
    
<span class="token number">2</span><span class="token punctuation">.</span> 使用值列表进行查询
	df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'索引1'</span><span class="token punctuation">,</span><span class="token string">'索引2'</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token string">&quot;列&quot;</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token comment">#得到Series</span>
    df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'索引1'</span><span class="token punctuation">,</span><span class="token string">'索引2'</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token string">'列1'</span>，<span class="token string">'列2'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token comment">#得到df</span>
    
<span class="token number">3</span><span class="token punctuation">.</span> 使用数值区间进行范围查询
	df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token string">'开始索引'</span><span class="token punctuation">:</span><span class="token string">'结束索引'</span><span class="token punctuation">,</span><span class="token string">'列'</span><span class="token punctuation">]</span><span class="token comment">#按行index区间进行查询</span>
    df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token string">'索引'</span><span class="token punctuation">,</span><span class="token string">'开始列'</span><span class="token punctuation">:</span><span class="token string">'结束列'</span><span class="token punctuation">]</span><span class="token comment">#按列index区间进行查询</span>
    df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token string">'开始索引'</span><span class="token punctuation">:</span><span class="token string">'结束索引'</span><span class="token punctuation">,</span><span class="token string">'开始列'</span><span class="token punctuation">:</span><span class="token string">'结束列'</span><span class="token punctuation">]</span><span class="token comment">#按行列区间查询</span>
    
<span class="token number">4</span><span class="token punctuation">.</span> 使用条件表达式查询
	df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span>df<span class="token punctuation">[</span><span class="token string">'列'</span><span class="token punctuation">]</span><span class="token operator">&lt;</span><span class="token operator">-</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token comment">#根据列小于10的行索引，列取全部</span>
    df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">'列1'</span><span class="token punctuation">]</span><span class="token operator">&lt;=</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token operator">&amp;</span><span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">'列2'</span><span class="token punctuation">]</span><span class="token operator">&gt;=</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">]</span> <span class="token comment">#复杂条件查询</span>
    
<span class="token number">5</span><span class="token punctuation">.</span> 调用函数查询
	df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token keyword">lambda</span> df<span class="token punctuation">:</span> <span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">'列1'</span><span class="token punctuation">]</span><span class="token operator">&lt;=</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token operator">&amp;</span><span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">'列2'</span><span class="token punctuation">]</span><span class="token operator">&gt;=</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">]</span>
    
    df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span>函数名<span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">]</span>
    <span class="token keyword">def</span> 函数名<span class="token punctuation">:</span>
        <span class="token keyword">return</span> df<span class="token punctuation">.</span>index<span class="token punctuation">.</span><span class="token builtin">str</span><span class="token punctuation">.</span>startswith<span class="token punctuation">(</span><span class="token string">&quot;xxx&quot;</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> df<span class="token punctuation">[</span><span class="token string">&quot;列&quot;</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token number">1</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><blockquote><p>适用行、列</p> <p>降维：dataFarme&gt;Series&gt;值</p></blockquote> <h2 id="新增数据列"><a href="#新增数据列" class="header-anchor">#</a> 新增数据列</h2> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token number">1</span><span class="token punctuation">.</span> 直接赋值
	df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token string">'列'</span><span class="token punctuation">]</span><span class="token operator">=</span>df<span class="token punctuation">[</span><span class="token string">&quot;列&quot;</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">str</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">&quot;C&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>astype<span class="token punctuation">(</span><span class="token string">'int32'</span><span class="token punctuation">)</span><span class="token comment">#替换</span>
	df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token string">'列3'</span><span class="token punctuation">]</span><span class="token operator">=</span>df<span class="token punctuation">[</span><span class="token string">&quot;列1&quot;</span><span class="token punctuation">]</span><span class="token operator">-</span>df<span class="token punctuation">[</span><span class="token string">'列2'</span><span class="token punctuation">]</span><span class="token comment">#新增</span>
    
<span class="token number">2</span><span class="token punctuation">.</span> <span class="token builtin">apply</span> 赋值
	<span class="token keyword">def</span> <span class="token function">set</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> x<span class="token punctuation">[</span><span class="token string">'列1'</span><span class="token punctuation">]</span><span class="token operator">&gt;</span><span class="token number">30</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span> <span class="token string">'高'</span>
        <span class="token keyword">if</span> x<span class="token punctuation">[</span><span class="token string">'列2'</span><span class="token punctuation">]</span><span class="token operator">&lt;</span><span class="token operator">-</span><span class="token number">10</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span> <span class="token string">'低'</span>
        <span class="token keyword">return</span> <span class="token string">'中'</span>
    df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token string">'wendu'</span><span class="token punctuation">]</span><span class="token operator">=</span>df<span class="token punctuation">.</span><span class="token builtin">apply</span><span class="token punctuation">(</span><span class="token builtin">set</span><span class="token punctuation">,</span>axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment">#columns=1,index=0</span>
    <span class="token comment">#统计=&gt;对相同类型的key进行统计</span>
    df<span class="token punctuation">[</span><span class="token string">'wendu'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>value_counts<span class="token punctuation">(</span><span class="token punctuation">)</span>
    
<span class="token number">3</span><span class="token punctuation">.</span> assign 同时添加多个列
	df<span class="token punctuation">.</span>assign<span class="token punctuation">(</span>
    	列<span class="token number">1</span><span class="token operator">=</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span>x<span class="token punctuation">[</span><span class="token string">'列1'</span><span class="token punctuation">]</span> <span class="token operator">*</span><span class="token number">9</span><span class="token operator">/</span><span class="token number">4</span> <span class="token operator">+</span><span class="token number">32</span><span class="token punctuation">,</span>
        列<span class="token number">2</span><span class="token operator">=</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span>x<span class="token punctuation">[</span><span class="token string">'列2'</span><span class="token punctuation">]</span> <span class="token operator">*</span><span class="token number">9</span><span class="token operator">/</span><span class="token number">4</span> <span class="token operator">+</span><span class="token number">32</span><span class="token punctuation">,</span>
    <span class="token punctuation">)</span>
    
<span class="token number">4</span><span class="token punctuation">.</span> 分条件赋值
	df<span class="token punctuation">[</span><span class="token string">'wencha'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">''</span>
	df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span>df<span class="token punctuation">[</span><span class="token string">'列1'</span><span class="token punctuation">]</span><span class="token operator">-</span>df<span class="token punctuation">[</span><span class="token string">'列2'</span><span class="token punctuation">]</span><span class="token operator">&gt;</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token string">'wencha'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">'温差大'</span>
	df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span>df<span class="token punctuation">[</span><span class="token string">'列1'</span><span class="token punctuation">]</span><span class="token operator">-</span>df<span class="token punctuation">[</span><span class="token string">'列2'</span><span class="token punctuation">]</span><span class="token operator">&lt;=</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token string">'wencha'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string">'温差正常'</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br></div></div><h2 id="数据统计函数"><a href="#数据统计函数" class="header-anchor">#</a> 数据统计函数</h2> <ul><li>汇总类统计</li> <li>唯一去重和按值计数</li> <li>相关系数和协方差</li></ul> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token comment"># 汇总类统计</span>
    df<span class="token punctuation">.</span>describe<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">#提取所有数字列统计结果  </span>
    <span class="token comment">#count统计、menan平均值、std标准差、min最小值、max最大值、分位数</span>
    df<span class="token punctuation">[</span><span class="token string">'列'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">#查看单个Serise的数据 p</span>
    df<span class="token punctuation">[</span><span class="token string">'列'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">max</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    df<span class="token punctuation">[</span><span class="token string">'列'</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token builtin">min</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    df<span class="token punctuation">[</span><span class="token string">'列'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>median<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">#中位数</span>

<span class="token comment"># 唯一去重和按值计数</span>
	df<span class="token punctuation">[</span><span class="token string">'列'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>unique<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">#出现值的范围，有那些值</span>
    df<span class="token punctuation">[</span><span class="token string">'列'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>value_counts<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">#统计每个值出现了多少次</span>
   
<span class="token comment"># 相关系数(相似度)和协方差(反向程度) =&gt;俩个股票的，正相关or负相关   产品销量的波动，跟那些因数正相关，负相关</span>
	df<span class="token punctuation">.</span>cov<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">#协方差矩阵  正 同向变化</span>
    df<span class="token punctuation">.</span>corr<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">#相关系数矩阵  1正相关 -1负相关</span>
    df<span class="token punctuation">[</span><span class="token string">'列'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>cov<span class="token punctuation">(</span><span class="token punctuation">)</span>
    df<span class="token punctuation">[</span><span class="token string">'列'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>corr<span class="token punctuation">(</span>df<span class="token punctuation">[</span><span class="token string">'列1'</span><span class="token punctuation">]</span><span class="token operator">-</span>df<span class="token punctuation">[</span><span class="token string">'列2'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><h2 id="缺失值处理"><a href="#缺失值处理" class="header-anchor">#</a> 缺失值处理</h2> <ul><li>isnull和notnull：检测是否有空值</li> <li>dropna：丢弃、删除缺失值
<ul><li>axis：删除行还是列=&gt; 0:index 1:columns 默认是0</li> <li>how：适用范围，如果等于any是任何，等于all为空才删除</li> <li>inplace：如果True修改当前df,否则返回新df</li></ul></li> <li>fillna：填充缺失值
<ul><li>value：用于填充的值，可以单个值，或者字典（key是列名，value是值）</li> <li>method：等于ffill使用前一个不为空的值填充；等于bfil使用后一个填充</li> <li>axis：按照行或列填充（0行1列）</li> <li>inplace：True原df修改,否则返回新df</li></ul></li></ul> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token comment">#检测空值</span>
	df<span class="token punctuation">.</span>isnull<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">#所有为空</span>
    df<span class="token punctuation">[</span><span class="token string">'列'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>isnull<span class="token punctuation">(</span><span class="token punctuation">)</span>
    df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span>df<span class="token punctuation">[</span><span class="token string">'列'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>notnull<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token comment">#筛选不为空的数据</span>
    
<span class="token comment">#删除全是空值的数据</span>
	df<span class="token punctuation">.</span>dropna<span class="token punctuation">(</span>axis<span class="token operator">=</span><span class="token string">'columns'</span><span class="token punctuation">,</span>how<span class="token operator">=</span><span class="token string">'all'</span><span class="token punctuation">,</span>inplace<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token comment">#全是空列</span>
	df<span class="token punctuation">.</span>dropna<span class="token punctuation">(</span>axis<span class="token operator">=</span><span class="token string">'index'</span><span class="token punctuation">,</span>how<span class="token operator">=</span><span class="token string">'all'</span><span class="token punctuation">,</span>inplace<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token comment">#全是空行</span>

<span class="token comment">#填充</span>
	df<span class="token punctuation">.</span>fillna<span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">&quot;列&quot;</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
    df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token string">'列'</span><span class="token punctuation">]</span><span class="token operator">=</span>df<span class="token punctuation">[</span><span class="token string">'列'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>fillna<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
    df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span><span class="token string">'列'</span><span class="token punctuation">]</span><span class="token operator">=</span>df<span class="token punctuation">[</span><span class="token string">'列'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>fillna<span class="token punctuation">(</span>method<span class="token operator">=</span><span class="token string">'ffill'</span><span class="token punctuation">)</span>
<span class="token comment">#保存</span>
	df<span class="token punctuation">.</span>to_excel<span class="token punctuation">(</span>路径<span class="token punctuation">,</span>index<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token comment">#不生成index数据</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h2 id="数据排序"><a href="#数据排序" class="header-anchor">#</a> 数据排序</h2> <ul><li><p>series排序</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>series<span class="token punctuation">.</span>sort_values<span class="token punctuation">(</span>ascending<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>inplace<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
<span class="token comment">#参数说明</span>
	ascending：<span class="token boolean">True</span>升序、<span class="token boolean">False</span>降序
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div></li> <li><p>DataFrame排序</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>DataFrame<span class="token punctuation">.</span>sort_values<span class="token punctuation">(</span>by<span class="token punctuation">,</span>ascending<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>inplace<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
<span class="token comment">#参数说明</span>
	ascending：<span class="token boolean">True</span>升序、<span class="token boolean">False</span>降序
    by<span class="token punctuation">:</span>字符串或者List<span class="token operator">&lt;</span>字符串<span class="token operator">&gt;</span> 单列排序或多列排序
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div></li></ul> <div class="language-python line-numbers-mode"><pre class="language-python"><code>df<span class="token punctuation">.</span>sort_values<span class="token punctuation">(</span>by<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'列1'</span>，<span class="token string">'列2'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>ascending<span class="token operator">=</span><span class="token punctuation">[</span><span class="token boolean">True</span><span class="token punctuation">,</span><span class="token boolean">False</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="字符串处理"><a href="#字符串处理" class="header-anchor">#</a> 字符串处理</h2> <blockquote><p>先调用str属性在调用对应字符串函数（df没有str属性和处理方法）</p> <p>只能字符串列上使用，不能在数字列上使用</p></blockquote> <div class="language-python line-numbers-mode"><pre class="language-python"><code>df<span class="token punctuation">.</span><span class="token builtin">str</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">&quot;替换&quot;</span>，<span class="token string">&quot;1&quot;</span><span class="token punctuation">)</span><span class="token comment">#支持正则替换</span>
df<span class="token punctuation">.</span><span class="token builtin">str</span><span class="token punctuation">.</span>isnumeric<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">#判断是不是数字</span>
df<span class="token punctuation">.</span><span class="token builtin">str</span><span class="token punctuation">.</span>startswith<span class="token punctuation">(</span><span class="token string">&quot;开头&quot;</span><span class="token punctuation">)</span>
df<span class="token punctuation">.</span><span class="token builtin">str</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">&quot;替换&quot;</span><span class="token punctuation">,</span><span class="token string">'1'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">str</span><span class="token punctuation">.</span>sclice<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token comment">#链式调用</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h2 id="axis参数"><a href="#axis参数" class="header-anchor">#</a> axis参数</h2> <ul><li>axis=0或index
<ul><li>如果是单行操作：指某一行</li> <li>如果是聚合操作：指跨行cross rows</li></ul></li> <li>axis=1或columns
<ul><li>单列操作，就指的是某一列</li> <li>聚合操作：指跨列cross columns</li></ul></li></ul> <h2 id="索引index"><a href="#索引index" class="header-anchor">#</a> 索引index</h2> <p>用途：</p> <ul><li>更方便的数据查询</li> <li>性能提升</li> <li>自动数据对齐</li> <li>更多更强大的数据结构支持</li></ul> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token comment">#设置索引</span>
df<span class="token punctuation">.</span>set_index<span class="token punctuation">(</span><span class="token string">'列名'</span><span class="token punctuation">,</span>inplace<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>drop<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token comment">#drop是让索引列还保在数据中</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h2 id="合并"><a href="#合并" class="header-anchor">#</a> 合并</h2> <ul><li><p>merge</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>pd<span class="token punctuation">.</span>merge<span class="token punctuation">(</span>left<span class="token punctuation">,</span>how<span class="token operator">=</span><span class="token string">'inner'</span><span class="token punctuation">,</span>on<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span>left_on<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span>left_index<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span>right_index<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span>sort<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>suffixes<span class="token operator">=</span><span class="token punctuation">(</span><span class="token string">'_x'</span><span class="token punctuation">,</span><span class="token string">'_y'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>copy<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span>indicator<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span>validate<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span>

left、right 要合并的df或有name的series
how join的类型
on join的key
left_on 左连接key
rigth_on 右连接的key
left_index<span class="token punctuation">,</span>right_index 使用index而不是普通的column做join
suffixes 俩个元素的后缀，列有重名自动加后缀
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div></li> <li><p>concat</p> <blockquote><p>使用某种合并方式(内外)，沿某个轴向(axis=0/1),把多个pandas对象合并成一个</p></blockquote> <div class="language-python line-numbers-mode"><pre class="language-python"><code>pd<span class="token punctuation">.</span>concat<span class="token punctuation">(</span>objs<span class="token punctuation">,</span>axis<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>join<span class="token operator">=</span><span class="token string">'outer'</span><span class="token punctuation">,</span>ignore_index<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
objs<span class="token punctuation">:</span> 一个列表 df或seres可混合
axis：默认是<span class="token number">0</span>按行合并，<span class="token number">1</span>是按列合并
join：合并时索引对齐方式 outer、inner
ignore_index 是否忽略原来的索引
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div></li> <li><p>append</p> <div class="language-python line-numbers-mode"><pre class="language-python"><code>df<span class="token punctuation">.</span>append<span class="token punctuation">(</span>other<span class="token punctuation">,</span>ignore_index<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
other<span class="token punctuation">:</span>ignore_index 是否忽略原来的索引单个df、series、<span class="token builtin">dict</span>、或列表
ignore_index 是否忽略原来的索引
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div></li></ul> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token comment">#连接</span>
pd<span class="token punctuation">.</span>merge<span class="token punctuation">(</span>表<span class="token number">1</span>，表<span class="token number">2</span>，left_on<span class="token operator">=</span><span class="token string">'表1key'</span><span class="token punctuation">,</span>right_on<span class="token operator">=</span><span class="token string">'表2key'</span><span class="token punctuation">,</span>how<span class="token operator">=</span><span class="token string">'inner'</span><span class="token punctuation">)</span><span class="token comment">#内连接</span>

<span class="token comment">#一对一，一对多，多对多数量对齐关系</span>
pd<span class="token punctuation">.</span>merge<span class="token punctuation">(</span>表<span class="token number">1</span><span class="token punctuation">,</span>表<span class="token number">2</span>，on<span class="token operator">=</span><span class="token string">'相同的列名'</span>）


<span class="token comment">#左右连接、内连接、外连接区别</span>
pd<span class="token punctuation">.</span>merge<span class="token punctuation">(</span>表<span class="token number">1</span><span class="token punctuation">,</span>表<span class="token number">2</span>，how<span class="token operator">=</span><span class="token string">'left'</span><span class="token punctuation">)</span>
pd<span class="token punctuation">.</span>merge<span class="token punctuation">(</span>表<span class="token number">1</span><span class="token punctuation">,</span>表<span class="token number">2</span>，how<span class="token operator">=</span><span class="token string">'right'</span><span class="token punctuation">)</span>
pd<span class="token punctuation">.</span>merge<span class="token punctuation">(</span>表<span class="token number">1</span><span class="token punctuation">,</span>表<span class="token number">2</span>，how<span class="token operator">=</span><span class="token string">'ourter'</span><span class="token punctuation">)</span> 
         
<span class="token comment">#重名处理</span>
pd<span class="token punctuation">.</span>merge<span class="token punctuation">(</span>表<span class="token number">1</span><span class="token punctuation">,</span>表<span class="token number">2</span>，on<span class="token operator">=</span><span class="token string">'相列名'</span><span class="token punctuation">,</span>suffixe<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'_left'</span><span class="token punctuation">,</span><span class="token string">'_right'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>         
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><h2 id="批量拆分和合并excel"><a href="#批量拆分和合并excel" class="header-anchor">#</a> 批量拆分和合并Excel</h2> <blockquote><p>拆分 df.iloc 合并df.concat()  保存df.toexcel()</p></blockquote> <h2 id="分组统计"><a href="#分组统计" class="header-anchor">#</a> 分组统计</h2> <blockquote><p>groupby</p></blockquote> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token comment">#分组使用聚合函数左数据统计</span>
	df<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">'列'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">#单列分组统计</span>
	df<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'列1'</span><span class="token punctuation">,</span><span class="token string">'列2'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">#多列分组统计</span>
    df<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'列1'</span><span class="token punctuation">,</span><span class="token string">'列2'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>as_index<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">#多列分组统计 不变成索引</span>
    df<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">'列'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>agg<span class="token punctuation">(</span><span class="token punctuation">[</span>np<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">,</span>np<span class="token punctuation">.</span>mean<span class="token punctuation">,</span>np<span class="token punctuation">.</span>std<span class="token punctuation">]</span><span class="token punctuation">)</span>	<span class="token comment">#查看多中数据统计</span>
    df<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">'列'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'列'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>agg<span class="token punctuation">(</span><span class="token punctuation">[</span>np<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">,</span>np<span class="token punctuation">.</span>mean<span class="token punctuation">,</span>np<span class="token punctuation">.</span>std<span class="token punctuation">]</span><span class="token punctuation">)</span>	<span class="token comment">#查看多中数据统计</span>
    df<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token string">'列'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>agg<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&quot;C列&quot;</span><span class="token punctuation">:</span>np<span class="token punctuation">.</span><span class="token builtin">sum</span><span class="token punctuation">,</span><span class="token string">&quot;D列&quot;</span><span class="token punctuation">:</span>np<span class="token punctuation">.</span>mean<span class="token punctuation">]</span><span class="token punctuation">)</span>	<span class="token comment">#不同列使用不同聚合函数    </span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h2 id="分层索引"><a href="#分层索引" class="header-anchor">#</a> 分层索引</h2> <div class="language-python line-numbers-mode"><pre class="language-python"><code><span class="token comment">#series</span>
r<span class="token operator">=</span>df<span class="token punctuation">.</span>groupby<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'公司'</span><span class="token punctuation">,</span><span class="token string">'日期'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'收盘'</span><span class="token punctuation">]</span><span class="token punctuation">.</span>mean<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">#分层索引</span>
r<span class="token punctuation">.</span>index
r<span class="token punctuation">.</span>unstack<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">#把二级索引变成列</span>
r<span class="token punctuation">.</span>reset_index<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">#变成普通的列</span>

r<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token string">'索引'</span><span class="token punctuation">]</span>
r<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token string">'索引1'</span><span class="token punctuation">,</span><span class="token string">'索引2'</span><span class="token punctuation">)</span><span class="token punctuation">]</span>

<span class="token comment">#datafrme</span>
df<span class="token punctuation">.</span>set_index<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'公司'</span><span class="token punctuation">,</span><span class="token string">'日期'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>inplace<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
df<span class="token punctuation">.</span>sort_index<span class="token punctuation">(</span>inplace<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
df<span class="token punctuation">.</span>loc<span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'1'</span><span class="token punctuation">,</span><span class="token string">'2'</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">:</span><span class="token punctuation">]</span>
df<span class="token punctuation">.</span>reset_index<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><h2 id="数据转换函数"><a href="#数据转换函数" class="header-anchor">#</a> 数据转换函数</h2> <ul><li>map：适用于series、实现每个值-&gt;指的映射</li> <li>apply：series实现对某个值的处理、用于df实现每个周的series的处理</li> <li>applymap：只能用于df</li></ul> <h2 id="数据透视和投射"><a href="#数据透视和投射" class="header-anchor">#</a> 数据透视和投射</h2> <ul><li>unstack实现数据二维透视</li> <li>pivot简化透视</li> <li>stack</li></ul></div> <footer class="page-edit" style="display:none;"><!----> <div class="last-updated"><span class="prefix">Last Updated: </span> <span class="time">2022/2/24 下午1:58:48</span></div></footer> <!----> <!----> <!----></main> <!----></div></div></div></div></div><div class="global-ui"><div class="back-to-ceiling" style="right:1rem;bottom:6rem;width:2.5rem;height:2.5rem;border-radius:.25rem;line-height:2.5rem;display:none;" data-v-c6073ba8 data-v-c6073ba8><svg t="1574745035067" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5404" class="icon" data-v-c6073ba8><path d="M526.60727968 10.90185116a27.675 27.675 0 0 0-29.21455937 0c-131.36607665 82.28402758-218.69155461 228.01873535-218.69155402 394.07834331a462.20625001 462.20625001 0 0 0 5.36959153 69.94390903c1.00431239 6.55289093-0.34802892 13.13561351-3.76865779 18.80351572-32.63518765 54.11355614-51.75690182 118.55860487-51.7569018 187.94566865a371.06718723 371.06718723 0 0 0 11.50484808 91.98906777c6.53300375 25.50556257 41.68394495 28.14064038 52.69160883 4.22606766 17.37162448-37.73630017 42.14135425-72.50938081 72.80769204-103.21549295 2.18761121 3.04276886 4.15646224 6.24463696 6.40373557 9.22774369a1871.4375 1871.4375 0 0 0 140.04691725 5.34970492 1866.36093723 1866.36093723 0 0 0 140.04691723-5.34970492c2.24727335-2.98310674 4.21612437-6.18497483 6.3937923-9.2178004 30.66633723 30.70611158 55.4360664 65.4791928 72.80769147 103.21549355 11.00766384 23.91457269 46.15860503 21.27949489 52.69160879-4.22606768a371.15156223 371.15156223 0 0 0 11.514792-91.99901164c0-69.36717486-19.13165746-133.82216804-51.75690182-187.92578088-3.42062944-5.66790279-4.76302748-12.26056868-3.76865837-18.80351632a462.20625001 462.20625001 0 0 0 5.36959269-69.943909c-0.00994388-166.08943902-87.32547796-311.81420293-218.6915546-394.09823051zM605.93803103 357.87693858a93.93749974 93.93749974 0 1 1-187.89594924 6.1e-7 93.93749974 93.93749974 0 0 1 187.89594924-6.1e-7z" p-id="5405" data-v-c6073ba8></path><path d="M429.50777625 765.63860547C429.50777625 803.39355007 466.44236686 1000.39046097 512.00932183 1000.39046097c45.56695499 0 82.4922232-197.00623328 82.5015456-234.7518555 0-37.75494459-36.9345906-68.35043303-82.4922232-68.34111062-45.57627738-0.00932239-82.52019037 30.59548842-82.51086798 68.34111062z" p-id="5406" data-v-c6073ba8></path></svg></div><!----></div></div>
    <script src="/assets/js/app.7036e47e.js" defer></script><script src="/assets/js/4.ec8df83f.js" defer></script><script src="/assets/js/1.d2920358.js" defer></script><script src="/assets/js/2.245be42e.js" defer></script><script src="/assets/js/58.95fa43c5.js" defer></script><script src="/assets/js/12.44af248e.js" defer></script>
  </body>
</html>
